---
layout: post
title: "Ruby on Rails Security Review: An Experience Report"
date: 2010-03-11
comments: false
categories:
 - Ruby
 - Rails
---

<div class='post'>
<div class="separator" style="clear: both; text-align: center;"><a href="http://farm4.static.flickr.com/3359/3244476512_5fbe80a529.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="341" src="http://farm4.static.flickr.com/3359/3244476512_5fbe80a529.jpg" width="400" /></a></div><div class="separator" style="clear: both; text-align: center;">Image credits to <a href="http://www.flickr.com/photos/intherough/">Wink</a>&nbsp;on Flickr (creative commons)</div><br />I was reviewing a Ruby on Rails source code to see the security implementations they have so far. They are about to launch their product for the first release and wanted to ensure they have the most obvious things checked. So, in a sense it was not supposed to be a hacking job for me, rather to check if the most well known security measures are in place. This is what I looked into so far:<br /><br /><ol><li><b>Password:</b> Password was encrypted using a salt. However, the default logger would log the password as they didn't use the <span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">filter_paramerer_logging</span> method.</li><li><b>Cross-Site Scripting</b><b>: </b>I was able to easily inject a script by just entering &lt;script&gt;alert('Script')&lt;/script&gt; when I signed up to the system and every time it would open an alert window whenever I navigated to a new page! So, I recommended them to use &lt;%= h %&gt;. However, Rails 3 does a good job of making this a default.</li><li><b>Authorization: </b>I found the weakest measure in the implementation of Authorization. For an example, there is a calendar in the web app where one can add/remove events. I found that any logged in user, not necessarily the event owner, could change/remove any calendar event. This was a shocker. Next, I found this same thing happening to the core models as well. The catch here is, they had a filter that checked if a user was logged in, but they didn't check if a user has rights to modify an instance of the object. For example, there is a project model, that can only be modified by the project owner. However, this per object ownership was not authorized and it was a huge potential security bug in my opinion.</li><li><b>File uploads: </b>The app was designed to upload the files to a folder underneath the <span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">public</span> folder. Which means, if the rails server was down, apache would serve the files directly to the user bypassing whatever security measure was taken inside the app.</li><li><b>PRG violation: </b>This is a good idea to follow a post-redirect-get pattern when an object is modified through <span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">post/delete/put</span> to ensure pressing the browser refresh button doesn't re-invoke the change. This wasn't done at some places which might end in multiple payments and such severe risks.</li><li><b>Direct public release: </b>I was a bit concerned that they wanted to go public release with their first ever release, even before having an alpha or at least in-house user. This is important because this application deals with money and credit cards. Trust is very important for such apps. So, I advised them to try this for some real works at home other than the <span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">"asdf asdf asdf...."(!)</span>&nbsp;kind inputs. This will help them spotting some of the odd behaviors early and cause less embarrassment.</li></ol><div>It was only a 4 hour assignment for me. Also, I was only limited to the source code and the test deployment that they have now. However, it seemed to me that, they might spend a few hours to fix the obvious errors and do some in-house real use before going to a public release.</div><div><br /></div></div>
