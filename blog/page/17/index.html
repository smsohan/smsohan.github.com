
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Sohan's Blog</title>
  <meta name="author" content="SM Sohan">

  
  <meta name="description" content="At ScrumPad most of our controllers are bounded by filters for authentication/authorization. Some filters apply to all actions in a controller while &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://smsohan.com/blog/page/17/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="" rel="alternate" title="Sohan's Blog" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-37549931-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body    class="collapse-sidebar sidebar-footer" >
  <header role="banner"><hgroup>
  <h1><a href="/">Sohan's Blog</a></h1>
  
    <h2>Things I'm Learning</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:smsohan.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/home">Home</a></li>
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/lifeline">Lifeline!</a></li>
  <li><a href="/blog/2013/04/05/call-me-sohan-and-ask-me-not-about-sm/">Call me Sohan!</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/05/13/unit-test-actioncontroller-filters/">Unit/Functional Test Rails ActionController Filters Following DRY</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-05-13T00:00:00-06:00" pubdate data-updated="true">May 13<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
<p>At <a href="http://scrumpad.com/" target="_blank">ScrumPad</a> most of our controllers are bounded by filters for authentication/authorization. Some filters apply to all actions in a controller while others apply to only a few or leave out only a few. However, since we are following TDD, we need to test the filter is invoked before each of the desired action. This makes the test code MOIST (not DRY)!</p><p><span style="color: rgb(0, 128, 0);"><strong>Example of Moist Code:</strong></span></p>  <p><span style="color: rgb(0, 128, 0);"><span style="color: rgb(0, 0, 0);">The following example only captures two test methods. However, if you have 30 controllers like ours and on an average 5 filters at each, you will possibly find many such duplicates making your test code so moist that it becomes shabby!</span><strong> </strong></span></p>  <pre class="brush: rails">class SomeController<br />before_filter :authenticate<br />before_filter :restrict_invalid_role<br />end<br />class SomeControllerTest<br />def test_index_redirects_without_login<br />get :index<br />assert_redirected_to :controller=&gt;:login, :action=&gt;:login<br />end<br />def test_index_redirects_without_valid_role<br />login_as(:invalid_role)<br />get :index<br />assert_redirected_to :controller=&gt;:exception, :action=&gt;:not_allowed<br />end<br />end</pre><br /><strong><span style="color: rgb(0, 128, 0);">Example of DRY Code:</span></strong><br />I came up with the following implementation to help us with unit testing the before filters. The assumption is, if your filter is invoked, it will work fine. And we are testing the filter only once. The following code is written at the end of the test/test_helper.rb.<br /><pre class="brush: rails">class ActionController::TestCase<br />##example: should_apply_before_filter_to_actions(:authenticate, [:index, :new])<br />def should_apply_before_filter_to_actions(before_filter_name, actions)<br />if(actions.nil? or actions.empty?)<br />  assert false<br />end<br />filter = find_maching_before_filter(before_filter_name)<br />actions.each do |action|<br />  assert_before_filter_applied(filter, action)<br />end<br />end<br />##example: should_apply_before_filter_to_action(:authenticate, :index)<br />def should_apply_before_filter_to_action(before_filter_name, action)<br />filter = find_maching_before_filter(before_filter_name)<br />assert_before_filter_applied(filter, action)<br />end<br /><br />##example: should_not_apply_before_filter_to_actions(:authenticate, [:index, :new])<br />def should_not_apply_before_filter_to_actions(before_filter_name, actions)<br />if(actions.nil? or actions.empty?)<br />  assert false<br />end<br />filter = find_maching_before_filter(before_filter_name)<br />actions.each do |action|<br />  assert_before_filter_not_applied(filter, action)<br />end<br />end<br /><br />##example: should_not_apply_before_filter_to_action(:authenticate, :index)<br />def should_not_apply_before_filter_to_action(before_filter_name, action)<br />filter = find_maching_before_filter(before_filter_name)<br />assert_before_filter_not_applied(filter, action)<br />end<br /><br />##example: should_apply_before_filters([:authenticate, :session_expiry])<br />def should_apply_before_filters(before_filter_names)<br />if(before_filter_names.nil? or before_filter_names.empty?)<br />  assert false, "No Before Filter is Passed"<br />end<br />before_filter_names.each {|filter| should_apply_before_filter(filter)}<br />end<br /><br />##example: should_apply_before_filter(:authenticate)<br />def should_apply_before_filter(before_filter_name)<br />filter = find_maching_before_filter(before_filter_name)<br />if(filter.nil?)<br />  assert false, "no matching filter found for #{before_filter_name}"<br />end<br />assert filter.options.empty?, "the filter #{before_filter_name} has only/except options and does not apply to all actions"<br />end<br /><br />private<br />#finds the matching BeforeFilter object<br />def find_maching_before_filter(before_filter_name)<br />filters = @controller.class.filter_chain()<br />if !filters.nil?<br />  filters.each do |filter|<br />    if(filter.is_a?(ActionController::Filters::BeforeFilter) and filter.method == before_filter_name)<br />      return filter<br />    end<br />  end<br />end<br />return nil<br />end<br /><br />#asserts a single BeforeFilter is applied on a single action<br />def assert_before_filter_applied(filter, action)<br />if(filter.nil? or action.nil?)<br />  assert false<br />end<br /><br />if(filter.options.empty?)<br />  assert true<br />  return<br />end<br />if(!filter.options[:only].nil?)<br />  assert filter.options[:only].include?(action.to_s)<br />end<br />if(!filter.options[:except].nil?)<br />  assert !filter.options[:except].include?(action.to_s)<br />end<br />end<br /><br />#asserts a single BeforeFilter is not applied on a single action<br />def assert_before_filter_not_applied(filter, action)<br />if(filter.nil? or action.nil?)<br />  assert false<br />end<br /><br />if(filter.options.empty?)<br />  assert false<br />end<br /><br />if(!filter.options[:except].nil?)<br />  assert filter.options[:except].include?(action.to_s)<br />end<br />if(!filter.options[:only].nil?)<br />  assert !filter.options[:only].include?(action.to_s)<br />end<br />end<br />end</pre>Now my test code looks like the following-<br /><pre class="brush: rails">  def test_filters<br />should_apply_before_filters(:authenticate, :restrict_invalid_role)<br />end </pre>I can use the other methods as well to get finer control if the before_filter is applied using :only or :except options. And I can use these helper methods across all my controller test classes, making the whole point of testing filters really neat and short.<br /><p>If you are familiar with shoulda tests, you will find the above code following shoulda like naming conventions. I found the above code to strip a lot of your efforts, since you eliminate all test codes that safeguard your filters.</p>Hope it helps someone with similar need.</div>
<h2>Comments</h2>
<div class='comments'>
<div class='comment'>
<div class='author'>a_ludi</div>
<div class='content'>
Thank you for your code base! This is quite useful to me, too. And probably to many others.<br /><br />I&#39;ve refactored your code a little:<br /><br />http://pastebin.com/ybuAPfbF<br /><br />Furthermore, I would advise to put this code into the test_helper.rb file, so all your tests can use it. Then you have to declare all methods except the assert* methods as private. The assert* methods should be public.</div>
</div>
</div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/04/26/object-oriented-design-in-custom/">Forget Me Not! Object Oriented Design in Custom Exception</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-04-26T00:00:00-06:00" pubdate data-updated="true">Apr 26<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
<p>When designing custom exceptions, you may forget about old school OO fundamentals. As a reminder, lets take a look into the following custom exception classes.</p> <pre class="brush: rails"><br />StorySaveError<br />StoryDescopeNotAllowedError<br />StoryCompleteError<br />StoryNotFoundError<br />StoryDeleteError<br />StoryDeleteNotAllowedError</pre><p>These exceptions are really useful in my application. But the bad thing is, they all derive from StandardError class, whereas there should be a base class, may be StoryError, which is more meaningful and useful. So, we can have the following-</p><pre class="brush: rails"><br />class StoryError < StandardError<br />end<br />StorySaveError < StoryError<br />StoryDescopeNotAllowedError < StoryError<br />StoryCompleteError < StoryError<br />StoryNotFoundError < StoryError<br />StoryDeleteError < StoryError<br />StoryDeleteNotAllowedError < StoryError</pre><p>With the addition of a base class for all Story related exceptions, I can write cleaner/better code.</p><ul><li>When I am not interested about the specific error, I can just use <code>rescue StoryError</code> to catch &#8216;em all</li><li>I can place a common error handling routine for all Story related exceptions</li><li>I can add new exception types without altering the codes where the specific type of StoryError is insignificant</li></ul><p>From my experience, I found that most people are not cautious about OO when desiging custom exceptions. (because they are exceptions!). Nonetheless, if you follow the OO guides, it will pay off for sure.</p>  </div>
<h2>Comments</h2>
<div class='comments'>
<div class='comment'>
<div class='author'>Sohan</div>
<div class='content'>
Yes, that is another way. Usually, people use ErrorCode to designate such cases. For example, WebException has many error codes in .Net. One code denotes timeout, another denotes network failure and so on.<br />One quick point, I saw you added attr_accessor :message. message is already an attribute of the Exception class, the base class of all Exceptions. So, you need not define a message property again. Its there and you can use it for free!</div>
</div>
<div class='comment'>
<div class='author'>Samiron Paul</div>
<div class='content'>
Just sharing a little experience. A situation where user may be failed to delete a task for any of two type of restrictions. But in both case &quot;TaskDeleteNotAllowed&quot; type exception will be raising. Hence it will not be possible to show the exact reason to user. Now instead of being so conservative by creating a new class, we came out in the following way<br /><br />Added a attribute in TaskDeleteNotAllowed:<br />Class TaskDeleteNotAllowed &lt; StandardError<br />    attr_accessor :message<br />end<br /><br />Create an instance of the class while before raising:<br />exception = TaskDeleteNotAllowed.new<br /><br />Setting custom message based on the error occurred and raise that:<br />exception.message = &quot;Task is completed&quot; #or any other message<br />raise exception<br /><br />Of course rescuing the error as following:<br />&#8230;<br />rescue TaskDeleteNotAllowed =&gt; error<br />   #show {error.message} in flash or write in log<br />&#8230;<br />That makes a proper sense to user whenever she fails to delete a task.<br /><br />Anyway, being concerned with OO fundamentals in  designing custom exception handlers is realized again.<br /><br />Thanks for the post</div>
</div>
</div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/04/21/unit-test-eager-loading-in-rails/">Unit Test Eager Loading in Rails ActiveRecord Association</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-04-21T00:00:00-06:00" pubdate data-updated="true">Apr 21<span>st</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
<p>To avoid the n+1 problem, you need to use eager loading in ActiveRecord object associations. An easy implementation of eager loading can be done using named scope in the following way.</p> <pre class="brush: rails">class User &lt; ActiveRecord::Base<br /> has_many :friends<br /> named_scope :eager_load_friends, :include =&gt; :fiends<br />end<br />User.find(user_id).eager_load_friends</pre>To unit test the named scope, you can use this following helper method (keep it in test_helper.rb, if you like) that I wrote for <a href="http://www.scrumpad.com/" target="_blank">ScrumPad</a><br /><pre class="brush: rails">def test_eager_loaded(model, association)<br /> assert !model.instance_variable_get("@#{association.to_s}").nil?<br />end</pre>You can then test your eager loading in the following way<br /><pre class="brush: rails">def test_eager_load_friends<br /> test_eager_loaded(User.find(1), :friends)<br />end</pre>You can also use the <a href="http://tammersaleh.com/posts/testing-named_scope" target="_blank">shoulda plug-in</a> if you like. For me, I think we should test the values returned by our named scope as opposed to shoulda approach, which tests if the code is written as expected.<br /><p>Got another solution? I will appreciate if you share.</p></div>
<h2>Comments</h2>
<div class='comments'>
<div class='comment'>
<div class='author'>Ashrafuzzaman</div>
<div class='content'>
Really useful.<br />And a clean way to reuse query.<br />Thanks for shearing</div>
</div>
</div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/04/15/implementing-template-method-in-rails/">Implementing Template Method in Rails Controllers Using Module and Mixin</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-04-15T00:00:00-06:00" pubdate data-updated="true">Apr 15<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
<p>All rails controllers are subclasses of the ApplicationController class. A typical controller class declaration will look like the following-</p> <pre class="brush: ruby;">class LoginController &lt; ApplicationController<br />#the actions go here<br />end</pre><p>With this basic information, I would like to state the problem first.</p><br /><strong><span style="color:#008000;">The Problem/Job in Hand</span></strong><br /><p>Add an action switch_project to all the controllers (&gt; 20) of the <a href="http://www.ScrumPad.com/" target="_blank">ScrumPad</a> code base. The implementations of the switch_project method will be same for all the controllers only other than the fact that, the switching destination will be different.</p><br /><strong><span style="color:#008000;">Analysis</span></strong><br /><p>Placing the switch_project action in the ApplicationController would be the best option. But, the methods of application controller are not accessible as actions. So, the following won’t work</p><br /><pre class="brush: rails">class ApplicationController<br /> def switch_project<br />   if(is_valid_switch?)<br />     logger.debug(“A switch is taking place”)<br />     destination = get_destination(new_project_id)<br />     redirect_to destination<br />   end<br /> end<br />end</pre><p>if you hit http://server/login/switch_project you will get a server side error. However, if you instead place the <code>switch_project</code> inside the <code>LoginController</code>, it will work fine. But, of course at a cost. You need to copy/paste this method 20+ times as there are 20+ controllers with the same need! Horrible!</p><br /><p>Again, as I said, the <code>get_destination(new_project_id)</code> is the only part that will be different for each of the controllers. So, we definitely find a template method here.</p><br /><strong><span style="color:#008000;">The Solution</span></strong><br /><p>If you need an introduction about Module and Mixin in Ruby, please read <a href="http://www.rubycentral.com/pickaxe/tut_modules.html" target="_blank">here at ruby-doc</a>. We are going to use Mixin to implement the desired solution, efficiently.<br /><br />So, I put the <code>switch_project</code> method in a module called, <code>ProjectSwitchModule</code> inside a new file at app/controllers/project_switch_module.rb like this-</p><br /><pre class="brush: rails;">module ProjectSwitchModule<br /> def switch_project<br />   if(is_valid_switch?)<br />     logger.debug(“A switch is taking place”)<br />     destination = get_destination(new_project_id)<br />     redirect_to destination<br />   end<br /> end<br /> def is_valid_switch?<br />   #I determine if the switch is valid at this method and return boolean<br /> end<br />end</pre><p>To make it available to all my controllers, I include this module in just in the <code>ApplicationController</code> in the following way-</p><br /><pre class="brush: rails;">require ‘project_switch_module’<br />class ApplicationController<br /> include ProjectSwitchModule<br />end</pre><br /><p>Also, to provide controller specific implementation of the get_destination(project_id) method, I am just writing this method in each of the controllers in the following way-</p><br /><pre class="brush: rails">class LoginController<br /> private<br /> def get_destination(project_id)<br />   #custom destination logic for LoginController<br /> end<br />end<br />class MessageController<br /> private<br /> def get_destination(project_id)<br />   #custom destination logic for MessageController<br /> end<br />end</pre><p>Now, if I invoke <a href="http://server/login/switch_project">http://server/login/switch_project</a> or <a href="http://server/message/switch_project">http://server/message/switch_project</a> I will get the result of the switch_project action. So, this gives us an elegant way to follow design patterns for efficient implementation. It will save a lot of my time in future when I need to change the switch_project method, since I just need to change at a single place instead of 20s.</p><br /><strong><span style="color:#008000;">Afterthoughts</span></strong><br /><p>If, for a controller the switch_project needs to be different from the template at the module, it is achieved simply by overriding the switch_project inside the controller. No worries!</p><br /><p>I will appreciate any feedback on this article.</p></div>
<h2>Comments</h2>
<div class='comments'>
<div class='comment'>
<div class='author'>Sohan</div>
<div class='content'>
Yes, in Ruby code block is a good way to implement templates. In most inumerator related templates, the library made extensive use of code blocks.</div>
</div>
<div class='comment'>
<div class='author'>Ashrafuzzaman</div>
<div class='content'>
Module and Mixin is an interesting way of implementing template.<br />&#8220;Code Block&#8221; can be one other alternative way.</div>
</div>
<div class='comment'>
<div class='author'>Arif</div>
<div class='content'>
Very good example of code reuse and single point of change.Thanks</div>
</div>
<div class='comment'>
<div class='author'>Sohan</div>
<div class='content'>
Thanks for your comment!</div>
</div>
<div class='comment'>
<div class='author'>Anonymous</div>
<div class='content'>
good post.</div>
</div>
</div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/04/11/testing-syntaxhighlighter-scripts/">Testing the SyntaxHighlighter Scripts</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-04-11T00:00:00-06:00" pubdate data-updated="true">Apr 11<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
<p>For the last few months, I am on the lookout for a really good syntax highlighter that helps me to post blogs on all the programming languages in a pretty html with syntax coloring/highlighting. This one is taken from <a title="http://alexgorbatchev.com/wiki/SyntaxHighlighter" href="http://alexgorbatchev.com/wiki/SyntaxHighlighter">http://alexgorbatchev.com/wiki/SyntaxHighlighter</a></p> <strong><span style="color:#008000;">Ruby/Rails</span></strong>   <pre class="brush: rails;">class TestHighlighter<br />def my_highlighter<br />  return "SyntaxHighlighter"<br />end<br />end</pre><br /><strong><span style="color:#008000;">CSharp</span></strong><br /><br /><pre class="brush: csharp;">public class TestHighlighter<br />{<br />public string MyHighlighter<br />{<br />  get {return "SyntaxHighlighter";}<br />}<br />}</pre><br /><br /><p><strong><span style="color:#008000;">W</span></strong><strong><span style="color:#008000;">hat did I add to my blog?</span></strong> </p><br /><br /><p>Open Edit Html and add this just before in the blog&#8217;s template </p><br /><br /><pre class="brush :html;">&lt;link href="http://alexgorbatchev.com/pub/sh/current/styles/shCore.css" type="text/css" rel="stylesheet" /&gt;<br />&lt;link href="http://alexgorbatchev.com/pub/sh/current/styles/shThemeDefault.css" type="text/css" rel="stylesheet" /&gt;<br />&lt;script src='http://alexgorbatchev.com/pub/sh/current/scripts/shCore.js' type='text/javascript'/&gt;<br />&lt;script src='http://alexgorbatchev.com/pub/sh/current/scripts/shBrushJScript.js' type='text/javascript'/&gt;<br />&lt;script src='http://alexgorbatchev.com/pub/sh/current/scripts/shBrushRuby.js' type='text/javascript'/&gt;<br />&lt;script src='http://alexgorbatchev.com/pub/sh/current/scripts/shBrushSql.js' type='text/javascript'/&gt;<br />&lt;script src='http://alexgorbatchev.com/pub/sh/current/scripts/shBrushXml.js' type='text/javascript'/&gt;<br />&lt;script src='http://alexgorbatchev.com/pub/sh/current/scripts/shBrushCSharp.js' type='text/javascript'/&gt;<br />&lt;script src='http://alexgorbatchev.com/pub/sh/current/scripts/shBrushCss.js' type='text/javascript'/&gt;<br />&lt;script type='text/javascript'&gt;<br />    SyntaxHighlighter.config.bloggerMode = true;<br />    SyntaxHighlighter.all();<br />&lt;/script&gt;</pre><br /><br /><p>Thanks to <a href="http://jitu-blog.blogspot.com/" target="_blank">Ashraf</a> for informing me about the <a href="http://www.codeplex.com/wlwSyntaxHighlighter" target="_blank">Windows Live Writer Plugin</a>! It will be useful for sure.</p></div>
<h2>Comments</h2>
<div class='comments'>
<div class='comment'>
<div class='author'>Ashif Manjur</div>
<div class='content'>
Thank you for posting such a helpful post. The code snippet posting has been much easier with this.</div>
</div>
<div class='comment'>
<div class='author'>Ashrafuzzaman</div>
<div class='content'>
This is a nice plugin too<br />http://sourcecodeplugin.codeplex.com/</div>
</div>
<div class='comment'>
<div class='author'>Ashrafuzzaman</div>
<div class='content'>
Here is an alternate plugin for live writer.<br />http://precode.codeplex.com/<br />Hope you like it :)</div>
</div>
<div class='comment'>
<div class='author'>Sohan</div>
<div class='content'>
@Ashraf, thanks! Good to know that it helps you.</div>
</div>
<div class='comment'>
<div class='author'>Ashrafuzzaman</div>
<div class='content'>
This is really a nice post. I was finding difficulties implementing it in blogger. But the post helped a lot. Thanks.</div>
</div>
</div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/04/09/pair-programming-how-am-i-feeling/">Pair Programming: How Am I Feeling?</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-04-09T00:00:00-06:00" pubdate data-updated="true">Apr 9<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
<p><strong>For an explanation of Pair Programming, please visit <a href="http://en.wikipedia.org/wiki/Pair_programming" target="_blank">this wiki entry</a>.</strong></p>  <p><strong><span style="color:#008000;">Good</span></strong></p>  <p>I am pair programming on the ScrumPad project now and the feeling in general is good. I have this perception is the work quality is better than doing alone. Also, the amount of time wasted to find small issues are now much reduced. Overall, its good.</p>  <p><strong><span style="color:#008000;">Productivity Increased</span></strong></p>  <p>I definitely found the productivity boosted by a factor of 1.5 at least. May be this is specific to my case, as I am working on a mid scale refactoring task. We worked on two user stories so far and completed the stories in 1.5 times faster compared to the individual estimates. We are doing estimation on a regular basis and the variance between estimation and actual hours are less than 5% as we see in the last 17 sprints in this project.</p>  <p><strong><span style="color:#008000;">Disclaimer</span></strong></p>  <p>I am yet new to this practice and not in a position to draw a conclusion yet. However, I believe our open space set-up and strong team culture helped us a lot to start this pair programming.</p>  <p>Are you pairing? Please, share your feelings and suggestions.</p></div>
<h2>Comments</h2>
<div class='comments'>
<div class='comment'>
<div class='author'>Sohan</div>
<div class='content'>
@Arif, Thanks for the comment. Yes, you are right. I also believe for certain routine (at least regular) jobs, pair programming will be more of an overhead than an advantage. But, when it comes to significant parts with high impact on issues/opportunities, Pair programming is surely worth.</div>
</div>
<div class='comment'>
<div class='author'>Arif</div>
<div class='content'>
Pair programming can play a vital role in reducing the bug rates and improving the overall quality of the code.I think every software project team should practice pair programming at least in the architecturally significant parts of the project.Pairing reduces defect rates during the final stage (deadline hours) of the project.Thanks for raising this significant issue.</div>
</div>
</div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/04/07/assertequalfloat-assertequal-between/">Assert_equal_float : Assert_equal Between Two Float Objects With Precision</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-04-07T00:00:00-06:00" pubdate data-updated="true">Apr 7<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
<p>In doing rails unit testing, sometime you need to assert the equality between two float objects in the following fashion</p>  <div class="code_div">   <p><strong><span style="font-size:100%;"><span style="font-family:Courier New;"><span style="color:#000080;">assert_equal</span> 32.8, object_under_test.method_returning_float</span></span></strong></p> </div>  <p>The internal storage of float objects sometimes will contain 32.8 with additional lower precision decimal points and hence the assert may fail although the significant digits may be same. For example, the value of <strong>object_under_test.method_returning_float</strong> may be stored as 32.80000001 in memory and the above call may fail.</p>  <p>To solve this problem, you may wish to use the <a href="http://www.ruby-doc.org/core-1.9/classes/Float.html" target="_blank">round method of Float class</a> in the following way</p>  <div class="code_div">   <p><strong><span style="font-size:100%;"><span style="font-family:Courier New;"><span style="color:#000080;">assert_equal</span> 32.8, object_under_test.method_returning_float<span style="color:#008000;">.round(1)</span></span></span></strong></p> </div>  <p>The above line will evaluate true since it will round up to one decimal points. However, be careful about cases where you may have a value greater than 5 in the second decimal place! because (32.86).to_f.round(1) will become 32.9!</p>  <p>However, when you are talking about insignificant digits, this rounding should work fine for you.</p>  <p>Next step is to define a new assert_equal_float method that takes the precision as an argument. Adding this method will save you from code duplication and will improve readability.</p>  <div class="code_div">   <p><span style="font-family:Courier New;"><strong><span style="font-size:100%;"><span style="color:#000080;">def</span> <span style="color:#800080;">assert_equal_float</span>(expected, actual, precision)            <br />    <span style="color:#008080;">assert_equal</span> expected.to_f.round(precision), actual.to_f.round(precision)            <br /><span style="color:#000080;">end</span></span></strong><span style="color:#000080;"> </span>   </span></p>    <p><span style="font-family:Courier New;"></span></p> </div>  <p>Happy float asserting!</p></div>
<h2>Comments</h2>
<div class='comments'>
<div class='comment'>
<div class='author'>tommy</div>
<div class='content'>
correction: round(precision) is available in ruby 1.9 but not in ruby 1.87 :(</div>
</div>
<div class='comment'>
<div class='author'>Tommy</div>
<div class='content'>
note:<br />(32.86).to_f.round(1) only works in Rails test environment because of active support<br /><br />.round(precision) isn&#39;t available in regular ruby code.</div>
</div>
</div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/04/05/looking-at-aspnet-mvc/">Looking at ASP.NET MVC</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-04-05T00:00:00-06:00" pubdate data-updated="true">Apr 5<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
<p>Being over-burdened by all the blog posts on MVC from the ASP.Net for the last few months, I am now looking to ASP.Net MVC. Still seeing the tutorials on <a href="http://asp.net/mvc" target="_blank">asp.net/mvc</a> site.</p>  <p>I have worked on a few rails projects and the ASP.Net MVC implementation is very much like Rails. Anyway, still early for me to comment!</p></div>
<h2>Comments</h2>
<div class='comments'>
<div class='comment'>
<div class='author'>Sohan</div>
<div class='content'>
@Tanvir,<BR/>Yes, I read the first chapter. My finding is ASP.Net MVC is still far from being real! The implementation of AJAX does not seem to be smart yet.<BR/>I would like to wait and see if the community really takes this framework in the coming days.</div>
</div>
<div class='comment'>
<div class='author'>Tanvir Anowar</div>
<div class='content'>
There is also a short book by ScottGu&#8217;s on MVC. You may find the download link from his blog.</div>
</div>
</div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/03/30/namedscope-real-life-examples-from/">Named_scope : Real Life Examples From ScrumPad</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-03-30T00:00:00-06:00" pubdate data-updated="true">Mar 30<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
<p>I am working on ScrumPad chat refactoring now. In rails 2, the named_scope feature works really great for ActiveRecord models. Lets start with the code first-</p>  <p><strong><span style="color: rgb(0, 128, 0);">The Source Code:</span></strong></p>  <div class="code_div">  <p><span style="font-family:Courier New;"><span style="color: rgb(0, 0, 128);">class</span> <strong><span style="color: rgb(0, 0, 255);">ChatUser</span></strong> &lt; ActiveRecord::Base    <br />belongs_to <span style="color: rgb(128, 0, 0);">:chat</span>    <br />belongs_to <span style="color: rgb(128, 0, 0);">:user</span>    <br />belongs_to <span style="color: rgb(128, 0, 0);">:chat_status, :foreign_key</span> =&gt; &#8220;status_id&#8221; </span></p>  <p><span style="font-family:Courier New;">  named_scope <span style="color: rgb(128, 0, 0);">:closed</span>, lambda {|chat_id| {<span style="color: rgb(128, 0, 0);">:conditions</span> =&gt; [&#8220;status_id = #{ChatStatus::CLOSED} AND chat_id = ? &#8220;, chat_id]}} do    <br />  <span style="color: rgb(0, 0, 128);">def</span> invite()    <br />    each { |chat_user| chat_user.update_attribute(<span style="color: rgb(128, 0, 0);">:status_id</span>, ChatStatus::INVITED) }    <br />  <span style="color: rgb(0, 0, 128);">end</span>    <br /><span style="color: rgb(0, 0, 128);">end</span> </span></p>   <p><span style="font-family:Courier New;">  named_scope <span style="color: rgb(128, 0, 0);">:active_chats</span>, lambda {|user_id| {<span style="color: rgb(128, 0, 0);">:conditions </span>=&gt; [&#8220;user_id = ? AND status_id not in (#{ChatStatus::CLOSED}, #{ChatStatus::LEFT})&#8221;, user_id]}}    <br />named_scope <span style="color: rgb(128, 0, 0);">:with_chat</span>, <span style="color: rgb(128, 0, 0);">:include</span> =&gt; <span style="color: rgb(128, 0, 0);">:chat</span>    <br /><span style="color: rgb(0, 0, 128);">end</span></span>  </p> </div> <p>So, you get an idea about the <span style="font-family:Courier New;">ChatUser</span> class. Its a relation object between user, chat and chat_status with some additional fields.</p>  <p><strong><span style="color: rgb(0, 128, 0);">How am I Using My named_scope?</span></strong></p>  <p><span style="font-family:Courier New;">ChatUser.closed(chat_id)</span></p>  <p>Gives me all the chat users who closed their chat windows for the chat having chat_id.</p>  <p><span style="font-family:Courier New;">ChatUser.closed(chat_id).with_chat</span></p>  <p>Gives me the same objects as previous but eager loads the chat object. So, it saves plenty of database calls when I need to iterate through the chats!</p>  <p><span style="font-family:Courier New;">ChatUser.closed(chat_id).invite()</span></p>  <p>Invites all users to a chat with chat_id if the buddy closed the chat window.</p>  <p><strong><span style="color: rgb(0, 128, 0);">Why named_scope?</span></strong></p>  <ol>   <li>named_scope is not just a syntactic sugar. It generates much less query using WHERE IN clause instead of WHERE = clause. So, reduces the number of calls to a single call. </li>    <li>Chaining the named_scope will generate only a single query for the chain. So, ChatUser.closed(chat_id).with_chat will produce only one query. </li>    <li>You get rid of looping in many cases! It will help you to write concise and clear codes. </li>    <li>When you can divide the objects in your classes in partitions, then you may wish to write the named_scope for partitioning the data. In my example, the :closed named_scope does this. So, I can add methods to this named_scope which actually works for the closed chats. It is kind of dividing your objects into named groups. So, it increases readability. </li> </ol>  <p>Let me know if you have another good example of a real life named_scope in your project.</p></div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/03/23/designcode-review-now-it-time-to/">Design/Code Review: Now, It&#8217;s Time to Realize!</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-03-23T00:00:00-06:00" pubdate data-updated="true">Mar 23<span>rd</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
<p><strong><span style="color: rgb(0, 128, 0);">Are you doing code reviews?</span></strong></p> <p>Thank God, you are. </p> <p><span style="color: rgb(255, 0, 0);"><strong>Not?</strong></span></p> <p>Well, you are not alone. You know, most of your bugs could be killed by reviews. Most of your technical debts could be paid by reviews. Your team could collectively learn more by reviews&#8230;</p> <p><strong><span style="color: rgb(0, 128, 0);">Now, It&#8217;s time to realize!</span></strong></p> <p>Start now! It&#8217;s simple. I have found the following approach to be useful-</p> <ol> <li>Pair up with one developer. Make it explicit to the team. So, you know who reviews your code.</li> <li>Mix up a junior team member with a senior one, if possible.</li> <li>Have a fixed time, at least 30 minutes for each two weeks to do a team design/code review.</li> <li>Do it in small increments. We did the following-</li></ol> <ul> <ul> <li>Sprint#1: Review variable/method/class/file/folder names only.</li> <li>Sprint#2: #1 + Review if/else blocks, loops.</li> <li>Sprint#3: #2 + Review class responsibilities.</li> <li>Sprint#4: #3 + Review test codes only.</li></ul></ul> <p><strong><span style="color: rgb(0, 128, 0);">The result is really worth</span></strong></p> <p>This first level feedback will help you to eliminate a lot of bugs, help in knowledge transfer and collective learning. Roughly, It takes only 10-15 minutes to review a code written in 3 days. I suggest, keep it simple.</p> <p>One interesting thing is, many times I have found the developer him/herself actually found bugs/mistakes in the code before the reviewer at the time or reviewing.</p> <p><span style="color: rgb(0, 128, 0);"><strong>A reviewer&#8217;s eye will save lot of your time and money.</strong></span></p><p><span style="color: rgb(0, 128, 0);"><strong>Update: Be constructive in your feedback! Example:-</strong></span></p><p style="color: rgb(0, 0, 0);"><span style="font-size:85%;"><strong>Worst: This code is a piece of &#8230;</strong></span></p><p style="color: rgb(0, 0, 0);"><span style="font-size:85%;"><strong>Worse: This code is bad</strong></span></p><p style="color: rgb(0, 0, 0);"><span style="font-size:85%;"><strong>Bad: This code is not good</strong></span></p><p style="color: rgb(0, 0, 0);"><span style="font-size:85%;"><strong>Good: A better way is..</strong></span></p><p style="color: rgb(0, 0, 0);"><span style="font-size:85%;"><strong>Better: We can also do it this way&#8230;</strong></span></p><p><span style="color: rgb(0, 128, 0);"><strong><span style="font-size:85%;"><span style="color: rgb(0, 0, 0);">Best ?</span></span><br /></strong></span></p></div>
<h2>Comments</h2>
<div class='comments'>
<div class='comment'>
<div class='author'>Sohan</div>
<div class='content'>
Yes, the positiveness or being constructive is very important. Thanks for reminding.</div>
</div>
<div class='comment'>
<div class='author'>Arif</div>
<div class='content'>
Nice and summarized post on a extremely useful topic like &#8220;Code Review&#8221;.It can be very effective if done regularly.<br /><br />One attention i would like to draw regarding this.Code reviewers should be constructive and positive about the comments made on the code written by others.If done with a TEAM mentality and positive attitude,Code Review is a great process for the overall quality improvement of  code.</div>
</div>
<div class='comment'>
<div class='author'>Ashrafuzzaman</div>
<div class='content'>
I agree.<BR/>Code review should be part of life.<BR/>It increases quality of code, the programmer and the reviewer himself.</div>
</div>
</div>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/18/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/16/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2020/11/12/learn-to-get-and-give-feedback/">Learn to Get and Give Feedback</a>
      </li>
    
      <li class="post">
        <a href="/blog/2020/11/04/youtube/">My YouTube Playlist for Leadership</a>
      </li>
    
      <li class="post">
        <a href="/blog/2020/10/12/managing-one-vs-many-teams/">Difference Between Managing One Team Vs. Many</a>
      </li>
    
      <li class="post">
        <a href="/blog/2020/10/11/communication-hacks-from-interview-feedback/">Communication Hacks I Learned From Job Interview Feedback</a>
      </li>
    
      <li class="post">
        <a href="/blog/2020/09/15/context/">Context</a>
      </li>
    
  </ul>
</section>
<section>
  <h1>LinkedIn Profile</h1>
  <p>
    <a href="http://www.linkedin.com/in/sohan">SM Sohan</a>
  </p>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/smsohan">@smsohan</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'smsohan',
            count: ,
            skip_forks: ,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>






  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2020 - SM Sohan -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  











</body>
</html>
