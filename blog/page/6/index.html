
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Sohan's Blog</title>
  <meta name="author" content="SM Sohan">

  
  <meta name="description" content="2013 was an amazing year in many ways for my personal life. To recap, the top story of 2013 was of course the birth of our son, Shopoth. And then, we &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://smsohan.com/blog/page/6/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="" rel="alternate" title="Sohan's Blog" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-37549931-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body    class="collapse-sidebar sidebar-footer" >
  <header role="banner"><hgroup>
  <h1><a href="/">Sohan's Blog</a></h1>
  
    <h2>Things I'm Learning</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:smsohan.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/home">Home</a></li>
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/lifeline">Lifeline!</a></li>
  <li><a href="/blog/2013/04/05/call-me-sohan-and-ask-me-not-about-sm/">Call me Sohan!</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/01/30/the-year-2014/">The Year 2014</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-01-30T15:04:00-07:00" pubdate data-updated="true">Jan 30<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>2013 was an amazing year in many ways for my personal life. To recap, the top story of 2013 was of course the birth of our son, Shopoth. And then, we bought our first house, paid off our car-loan and ended the year with a much needed vacation, that too to Bangladesh where we spent some quality time with the families.</p>

<p>2013 was my year of learning Haskell. I can&#8217;t claim to be a seasoned Haskell programmer yet. But I think I learned a lot of new concepts that you only see once you&#8217;re left in the unchartered territory of a functional programming language. So, in 2014, Haskell still remains a the language I want to get better at.</p>

<p>I&#8217;d like to change a few things in 2014 in terms of my career. It&#8217;s been almost 8 years since I&#8217;ve been developing web apps on the job. It&#8217;s been exciting and I feel overwhelmed when I look back at how far the industry has matured over the years. However, at the same time, <strong>in 2014, I&#8217;d like to focus on my soft-skills, especially on my negotiation skills</strong>. The target is to practice negotiation before I need to negotiate with others, so I&#8217;m well prepared to share my opinion about a topic. And afterwards, do a retrospective to find out room for improvement.</p>

<p>In 2013, I also got a PhD admission at the University of Calgary. So far, I&#8217;ve enrolled into only a single course. But the target is to publish one paper on API evolution by the end of this summer.</p>

<p>2014 is the first year of my thirties. I guess, <strong>I should start checking off items from my bucket list</strong> from now on. Still debating which one to target in 2014: a) learn to fly an airplane, b) start my own side project. Will keep you posted when I&#8217;ve made my mind. Happy 2014 till then.</p>

<p>Oh, before I conclude, here&#8217;s some stats about my open source contribution in 2013:</p>

<ol>
<li>40K+ downloads of <a href="http://www.nuget.org/packages/MvcMailer">MvcMailer</a></li>
<li>400+ downloads of <a href="http://www.nuget.org/packages/TextHelper">TextHelper</a></li>
<li>1.5K+ downloads of <a href="http://rubygems.org/gems/streamy_csv">streamy_csv</a></li>
<li>17K+ visits to <a href="/blog">my blog</a></li>
</ol>


<p>In 2014, I&#8217;d like to continue my open source contribution, preferably to some well established projects.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/11/03/configure-me-not/">Configure Me Not</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-11-03T21:29:00-07:00" pubdate data-updated="true">Nov 3<span>rd</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Configuration in software provides a method to build systems that can
adapt to different configurations. For example, if a website&#8217;s language and
date/currency formats are configurable, then it can be configured to
support multiple languages and regional formats. Configuration makes it
possible to deliver such features without needing a log of change in the
application source code.</p>

<p>However, this notion of flexibility that configuration provides can be a trap at times. I&#8217;ve a definition of configurable as follows:</p>

<blockquote><p>A configurable must have at least two configurations.</p></blockquote>

<p>This is another way of saying YAGNI. But I find this to be more specific
than YAGNI, as it quantifies and makes it apparent.</p>

<p>Here are a few examples to illustrate my definition.</p>

<ol>
<li><p> <strong>Custom interfaces with a single implementation.</strong></p>

<p> Interfaces are often times thought as a configurable component, as a new
 implementation can be used in place of an old one without changing the
 code that uses it.</p>

<p> Except, if your interface only ever have one implementation, this
 provides a false notion of flexibility. In practice, I&#8217;ve seen for most
 custom interfaces, a new implementation almost always needs a change in
 the original interface which doesn&#8217;t really make it configurable
 anymore.</p></li>
<li><p><strong>Default arguments in methods that are never passed a non-default
value.</strong></p>

<p> Default arguments are great, as they often times simplify the common
 case. However, if a method with a default argument is never called
 with a non-default value, it&#8217;s simply not worth using a default argument. Use a local variable instead.</p></li>
<li><p><strong>Configuration key value pairs where there&#8217;s only one value.</strong></p>

<p> Since magic numbers and hardcoded strings are bad, it&#8217;s tempting to use
 the configuration file to hold such values. However, if there&#8217;s only one
 such value, it&#8217;s probably a constant and not a configurable object.</p></li>
<li><p><strong>Exhaustively validating method parameters against all possible but unused values.</strong></p>

<p> If you&#8217;re writing a method that&#8217;s only gonna be called from another
 method in your project, you probably know what you&#8217;re passing to the
 method. Validating for different negative inputs to such methods provide
 a sense of robustness without really adding any value to it.</p></li>
</ol>


<p>Hoping, the definition makes sense. Would love to hear your
opinion and examples of configure me not.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/10/08/how-to-introduce-asset-pipeline-for-older-apps/">Introducing Asset Pipeline to Older Apps?</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-10-08T10:12:00-06:00" pubdate data-updated="true">Oct 8<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Introducing Asset Pipeline to an old project is quite hard. Most pre-asset pipeline projects used small JavaScript/CSS files that are often scoped to a single page or a part of the application. A typical example is as follows:</p>

<figure class='code'><figcaption><span>login.js</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">$</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#login&#39;</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">isLoginValid</span> <span class="o">=</span> <span class="nx">hasValue</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#user_name&#39;</span><span class="p">))</span> <span class="o">&amp;&amp;</span> <span class="nx">hasValue</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#user_password&#39;</span><span class="p">));</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span><span class="p">(</span><span class="nx">isLoginValid</span><span class="p">){</span>
</span><span class='line'>      <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#login_errors&#39;</span><span class="p">).</span><span class="nx">hide</span><span class="p">();</span>
</span><span class='line'>      <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#login_form&#39;</span><span class="p">).</span><span class="nx">submit</span><span class="p">();</span>
</span><span class='line'>    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#login_errors&#39;</span><span class="p">).</span><span class="nx">show</span><span class="p">();</span>
</span><span class='line'>      <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now, within the scope of the login page this code executes just fine. However, with asset pipeline, if this file is included in the application manifest, then all pages that include the manifest will execute this code on load. This is wasteful and more importantly, may result in unexpected behaviors and conflicts.</p>

<p>To work around this problem, when introducing asset pipeline, the code needs to be wrapped in some method that can be called to initialize it only from the login page. Here&#8217;s an example of the wrapper method:</p>

<figure class='code'><figcaption><span>login.js</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'>  <span class="nx">App</span><span class="p">.</span><span class="nx">validateLogin</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#login&#39;</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">isLoginValid</span> <span class="o">=</span> <span class="nx">hasValue</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#user_name&#39;</span><span class="p">))</span> <span class="o">&amp;&amp;</span> <span class="nx">hasValue</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#user_password&#39;</span><span class="p">));</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">if</span><span class="p">(</span><span class="nx">isLoginValid</span><span class="p">){</span>
</span><span class='line'>        <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#login_errors&#39;</span><span class="p">).</span><span class="nx">hide</span><span class="p">();</span>
</span><span class='line'>        <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#login_form&#39;</span><span class="p">).</span><span class="nx">submit</span><span class="p">();</span>
</span><span class='line'>      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#login_errors&#39;</span><span class="p">).</span><span class="nx">show</span><span class="p">();</span>
</span><span class='line'>        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'>  <span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now that the logic is wrapped inside a method, it can be included in all the pages without causing any wasteful execution and risking unexpected outcomes or conflicts. This method can be called from within the login page as shown in the following example:</p>

<figure class='code'><figcaption><span>login.html.erb</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>    <span class="nx">App</span><span class="p">.</span><span class="nx">validateLogin</span><span class="p">();</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'><span class="nt">&lt;/script&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>This is of course only a minimum change approach that&#8217;ll get asset pipelines working for an existing app. I&#8217;d recommend refactoring the code to make it testable and adding unit tests as you go.</p>

<p>We have a 4 year old Ruby on Rails project, and now running 3.2 with asset pipelines. It has only one manifest file. We used this simple approach to convert all existing js code and it worked great. Hope it helps when you start upgrading your assets to use the pipelines.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/09/19/career-choices-should-i-take-this-job/">Career Choices: Should I Take This Job?</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-09-19T16:47:00-06:00" pubdate data-updated="true">Sep 19<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I get intimidated by this question, &#8220;Should I take this job?&#8221;</p>

<p>Growing up, my dad had a huge influence on my upbringing. He had a government job and it was the only job he ever had (retired in 2012). However, my generation Y seems somewhat lucky to be able to pick and choose a job, once every couple years or so. And every time I feel like it&#8217;s time to start looking around for that next job, I get intimidated by this question.</p>

<p>I think this is because, I put a lot of passion into the work I do. I also feel proud of my work. So, when it gets boring, and learning opportunity gets flat, it rings that bell - &#8220;what&#8217;s out there?&#8221;</p>

<p>We get comfortable around the people at work, build relationships and know the businesses inside out. The thought of leaving the comfort zone intimidates me. At the same time, a new work, working with new people and just a lot of learning opportunity gets me excited. So, everytime I need to solve this trade-off, it becomes a huge mental load for me. Last time, when I left ThoughtWorks, the mental load was paramount, and here&#8217;s how I made up my mind:</p>

<p>I focused on the <em>worst case</em> and <em>best case</em> outcomes. For me, the worst case was if the new job I was taking would leave me jobless, right when Shopoth, my son, was due to be born. I was pretty confident that wasn&#8217;t gonna happen until something really bad happened. The next in line was, if work and life at the new place turns out to be too bad that I&#8217;d have to find a new job right after. If it indeed happened, I timeboxed it to at least see it for 8 months, when our new born baby would be 4 months old and we&#8217;d possibly get somewhat settled. With these two items checked, I felt somewhat comfortable with the decision to move.</p>

<p>The best case for me was the opportunity to lead some innovations while making good income. Both seemed to be in place. So, I made the decision. It worked out pretty well till now. I hope the Best/Worst case outcome thing helps you in making your decision.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/08/27/will-you-put-that-cell-phone-away/">Will You Put That Cell Phone Away?</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-08-27T15:12:00-06:00" pubdate data-updated="true">Aug 27<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I know it&#8217;s your phone and you can do anything you want. But may be it&#8217;s worth holding back at times. There&#8217;s more to life than our screens.</p>

<p>I&#8217;m leaving it off the hand, off the table and off the bed, in silent mode, all day long. I&#8217;m asking for permission to use it if I have to while I&#8217;m with others. Instead of spending the time with the screens, it&#8217;s been very rewarding to play with my little son, with all the attention on him. My little guy sure senses the attention and you can tell it just from looking at his eyes.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/08/12/algorithms-need-better-ui/">Algorithms Need Better UI</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-08-12T09:34:00-06:00" pubdate data-updated="true">Aug 12<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Since 2006, as I became a professional software engineer, I spent a fair amount of time reading books and online articles about software. Most topics were around Object Orientation, Web technologies, Software design, Testing, Automation, Agile and Lean, etc. Last year, I decided to take a break from such topics on purpose. So, I cleared all my RSS subscriptions.</p>

<p>Instead, I thought I would revisit some of the algorithms that I learned during my undergraduate courses. It&#8217;s been a few years since I studied algorithms and I thought I was more seasoned to appreciate and solve some of the algorithm problems than in the past. So, I started with the dynamic programming problems such as: <a href="http://en.wikipedia.org/wiki/Longest_common_subsequence_problem">Longest Common Subsequence (LCS)</a> and <a href="http://en.wikipedia.org/wiki/Knapsack_problem">Knapsack Problem</a> and found this solution in Wikipedia:</p>

<figure class='code'><figcaption><span>Source code for finding the lenght of the Longest Common Subsequence</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">function</span> <span class="nx">LCSLength</span><span class="p">(</span><span class="nx">X</span><span class="p">[</span><span class="mi">1</span><span class="p">..</span><span class="nx">m</span><span class="p">],</span> <span class="nx">Y</span><span class="p">[</span><span class="mi">1</span><span class="p">..</span><span class="nx">n</span><span class="p">])</span>
</span><span class='line'>    <span class="nx">C</span> <span class="o">=</span> <span class="nx">array</span><span class="p">(</span><span class="mi">0</span><span class="p">..</span><span class="nx">m</span><span class="p">,</span> <span class="mi">0</span><span class="p">..</span><span class="nx">n</span><span class="p">)</span>
</span><span class='line'>    <span class="k">for</span> <span class="nx">i</span> <span class="o">:=</span> <span class="mi">0</span><span class="p">..</span><span class="nx">m</span>
</span><span class='line'>       <span class="nx">C</span><span class="p">[</span><span class="nx">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span class='line'>    <span class="k">for</span> <span class="nx">j</span> <span class="o">:=</span> <span class="mi">0</span><span class="p">..</span><span class="nx">n</span>
</span><span class='line'>       <span class="nx">C</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span class='line'>    <span class="k">for</span> <span class="nx">i</span> <span class="o">:=</span> <span class="mi">1</span><span class="p">..</span><span class="nx">m</span>
</span><span class='line'>        <span class="k">for</span> <span class="nx">j</span> <span class="o">:=</span> <span class="mi">1</span><span class="p">..</span><span class="nx">n</span>
</span><span class='line'>            <span class="k">if</span> <span class="nx">X</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span>
</span><span class='line'>                <span class="nx">C</span><span class="p">[</span><span class="nx">i</span><span class="p">,</span><span class="nx">j</span><span class="p">]</span> <span class="o">:=</span> <span class="nx">C</span><span class="p">[</span><span class="nx">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="nx">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
</span><span class='line'>            <span class="k">else</span>
</span><span class='line'>                <span class="nx">C</span><span class="p">[</span><span class="nx">i</span><span class="p">,</span><span class="nx">j</span><span class="p">]</span> <span class="o">:=</span> <span class="nx">max</span><span class="p">(</span><span class="nx">C</span><span class="p">[</span><span class="nx">i</span><span class="p">,</span><span class="nx">j</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="nx">C</span><span class="p">[</span><span class="nx">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="nx">j</span><span class="p">])</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">C</span><span class="p">[</span><span class="nx">m</span><span class="p">,</span><span class="nx">n</span><span class="p">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>As a software developer, when I&#8217;m reading an article, if there is an accompanied source code, my eyes automatically scroll into it skipping any textual blurb. It was the same in this case, and I must say, I noticed a few things here:</p>

<ol>
<li>The single literal variable names need some love.</li>
<li>The code can use some logical grouping and naming to easily communicate what&#8217;s happening here.</li>
</ol>


<p>I found this to be an UI problem. The algorithm itself is quite complicated for an average person to understand. However, we can probably reduce some noise with better naming/grouping. Here&#8217;s an alternate version of the same code.</p>

<figure class='code'><figcaption><span>Modified source code, with descriptive names</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">function</span> <span class="nx">LCSLength</span><span class="p">(</span><span class="nx">sequence1</span><span class="p">[</span><span class="mi">1</span><span class="p">..</span><span class="nx">sequence1Size</span><span class="p">],</span> <span class="nx">sequence2</span><span class="p">[</span><span class="mi">1</span><span class="p">..</span><span class="nx">sequence2Size</span><span class="p">])</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">table</span> <span class="o">=</span> <span class="nx">GetTableWithZerosInFirstRowAndColumn</span><span class="p">(</span><span class="nx">sequence1Size</span><span class="p">,</span> <span class="nx">sequence2Size</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">for</span> <span class="nx">sequence1Index</span> <span class="o">:=</span> <span class="mi">1</span><span class="p">..</span><span class="nx">sequence1Size</span>
</span><span class='line'>        <span class="k">for</span> <span class="nx">sequence2Index</span> <span class="o">:=</span> <span class="mi">1</span><span class="p">..</span><span class="nx">sequence2Size</span>
</span><span class='line'>
</span><span class='line'>            <span class="k">if</span> <span class="nx">sequence1</span><span class="p">[</span><span class="nx">sequence1Index</span><span class="p">]</span> <span class="o">=</span> <span class="nx">sequence2</span><span class="p">[</span><span class="nx">sequence2Index</span><span class="p">]</span>
</span><span class='line'>              <span class="nx">IncrementLength</span><span class="p">(</span><span class="nx">table</span><span class="p">,</span> <span class="nx">sequence1Index</span><span class="p">,</span> <span class="nx">sequence2Index</span><span class="p">)</span>
</span><span class='line'>            <span class="k">else</span>
</span><span class='line'>              <span class="nx">UseCurrentLength</span><span class="p">(</span><span class="nx">table</span><span class="p">,</span> <span class="nx">sequence1Index</span><span class="p">,</span> <span class="nx">sequence2Index</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">return</span> <span class="nx">table</span><span class="p">[</span><span class="nx">sequence1Size</span><span class="p">,</span> <span class="nx">sequence2Size</span><span class="p">]</span>
</span><span class='line'>
</span><span class='line'><span class="kd">function</span> <span class="nx">GetTableWithZerosInFirstRowAndColumn</span><span class="p">(</span><span class="nx">columns</span><span class="p">,</span> <span class="nx">rows</span><span class="p">)</span>
</span><span class='line'>  <span class="nx">table</span> <span class="o">=</span> <span class="nx">array</span><span class="p">(</span><span class="mi">0</span><span class="p">..</span><span class="nx">column</span><span class="p">,</span> <span class="mi">0</span><span class="p">..</span><span class="nx">rows</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">InitializeFirstRowWithZeros</span><span class="p">(</span><span class="nx">table</span><span class="p">)</span>
</span><span class='line'>  <span class="nx">InitializeFirstColumnWithZeros</span><span class="p">(</span><span class="nx">table</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">return</span> <span class="nx">table</span>
</span><span class='line'>
</span><span class='line'><span class="kd">function</span> <span class="nx">InitializeFirstRowWithZeros</span><span class="p">(</span><span class="nx">table</span><span class="p">[</span><span class="nx">columns</span> <span class="nx">x</span> <span class="nx">rows</span><span class="p">])</span>
</span><span class='line'>  <span class="k">for</span> <span class="nx">columnIndex</span> <span class="o">:=</span> <span class="mi">0</span><span class="p">..</span><span class="nx">columns</span>
</span><span class='line'>       <span class="nx">table</span><span class="p">[</span><span class="nx">columnIndex</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span class='line'>
</span><span class='line'><span class="kd">function</span> <span class="nx">InitializeFirstColumnWithZeros</span><span class="p">(</span><span class="nx">table</span><span class="p">[</span><span class="nx">columns</span> <span class="nx">x</span> <span class="nx">rows</span><span class="p">])</span>
</span><span class='line'>  <span class="k">for</span> <span class="nx">rowIndex</span> <span class="o">:=</span> <span class="mi">1</span><span class="p">..</span><span class="nx">rows</span>
</span><span class='line'>       <span class="nx">table</span><span class="p">[</span><span class="nx">rowIndex</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span class='line'>
</span><span class='line'><span class="kd">function</span> <span class="nx">IncrementLength</span><span class="p">(</span><span class="nx">table</span><span class="p">,</span> <span class="nx">columnIndex</span><span class="p">,</span> <span class="nx">rowIndex</span><span class="p">)</span>
</span><span class='line'>    <span class="nx">table</span><span class="p">[</span><span class="nx">columnIndex</span><span class="p">,</span><span class="nx">rowIndex</span><span class="p">]</span> <span class="o">:=</span> <span class="nx">table</span><span class="p">[</span><span class="nx">columnIndex</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="nx">rowIndex</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
</span><span class='line'>
</span><span class='line'><span class="kd">function</span> <span class="nx">UseCurrentLength</span><span class="p">(</span><span class="nx">table</span><span class="p">,</span> <span class="nx">columnIndex</span><span class="p">,</span> <span class="nx">rowIndex</span><span class="p">)</span>
</span><span class='line'>    <span class="nx">leftCell</span> <span class="o">=</span> <span class="nx">table</span><span class="p">[</span><span class="nx">columnIndex</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="nx">rowIndex</span><span class="p">]</span>
</span><span class='line'>    <span class="nx">topCell</span> <span class="o">=</span> <span class="nx">table</span><span class="p">[</span><span class="nx">columnIndex</span><span class="p">,</span><span class="nx">rowIndex</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span class='line'>    <span class="nx">table</span><span class="p">[</span><span class="nx">columnIndex</span><span class="p">,</span><span class="nx">rowIndex</span><span class="p">]</span> <span class="o">:=</span> <span class="nx">max</span><span class="p">(</span><span class="nx">leftCell</span><span class="p">,</span> <span class="nx">topCell</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>I know this modified code is verbose, but I find it self explanatory. Using descriptive names are not a new concept in software engineering at all. I wish we had our algorithm books with annotated source code like this, where it&#8217;s readable by humans.</p>

<p>Let&#8217;s use uglifiers and minifiers to do the machinification for us.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/06/14/angularjs-is-very-productive-and-cool/">AngularJS Is Very Productive, and Cool Too!</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-06-14T13:10:00-06:00" pubdate data-updated="true">Jun 14<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>It has a very steep learning curve, but yields a superb productivity boost once you&#8217;ve learned it. Check out <a href="http://smsohan.com/angular_wizard/">my demo of the wizard</a> that we&#8217;ll discuss next.</p>

<p>AngularJS works by extending HTML to produce declarative UI code and eliminating the need for a lot of boilerplate code. For example, the mental model of a wizard can be expressed using the following HTML:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;wizard title="Flight Search"&gt;
</span><span class='line'>
</span><span class='line'>  &lt;step title="Search"&gt;
</span><span class='line'>
</span><span class='line'>  &lt;/step&gt;
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>  &lt;step title="Select a flight"&gt;
</span><span class='line'>
</span><span class='line'>  &lt;/step&gt;
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>  &lt;step title="Select a return flight"&gt;
</span><span class='line'>
</span><span class='line'>  &lt;/step&gt;
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>  &lt;step title="Checkout"&gt;
</span><span class='line'>
</span><span class='line'>  &lt;/step&gt;
</span><span class='line'>
</span><span class='line'>  &lt;step title="Confirm purchase"&gt;
</span><span class='line'>
</span><span class='line'>  &lt;/step&gt;
</span><span class='line'>
</span><span class='line'>  &lt;step title="Receipt"&gt;
</span><span class='line'>
</span><span class='line'>  &lt;/step&gt;
</span><span class='line'>
</span><span class='line'>&lt;/wizard&gt;
</span></code></pre></td></tr></table></div></figure>


<p>With AngularJS, one can write exactly this markup with the help of two custom directives, <code>widget</code> and <code>step</code>. This declarative UI code makes it very easy to read. In addition to this, the two way data binding capabilities of AngularJS makes it very productive as we don&#8217;t need to write a bunch of references to the DOM nodes and render the nodes as the data changes. For a working example, check the source code of the demo and if you are like me, you&#8217;ll love to see how simple it is.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/05/10/released-streamy-csv-gem/">Released Streamy_csv Gem</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-05-10T08:38:00-06:00" pubdate data-updated="true">May 10<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Following the <a href="/blog/2013/05/09/genereating-and-streaming-potentially-large-csv-files-using-ruby-on-rails/">previous post</a>, I decided to spin off a little ruby gem for you folks. Get streamy_csv, and write only your application code while it&#8217;ll do the boilerplate work for you.</p>

<p>In a nutshell, with this gem in your application, all you need to do is this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">Class</span> <span class="no">ExportsController</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">index</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">stream_csv</span><span class="p">(</span><span class="s1">&#39;data.csv&#39;</span><span class="p">,</span> <span class="no">MyModel</span><span class="o">.</span><span class="n">header_row</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">rows</span><span class="o">|</span>
</span><span class='line'>      <span class="no">MyModel</span><span class="o">.</span><span class="n">find_each</span> <span class="k">do</span> <span class="o">|</span><span class="n">my_model</span><span class="o">|</span>
</span><span class='line'>        <span class="n">rows</span> <span class="o">&lt;&lt;</span> <span class="n">my_model</span><span class="o">.</span><span class="n">to_csv_row</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Find more at <a href="https://github.com/smsohan/streamy_csv">https://github.com/smsohan/streamy_csv</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/05/09/genereating-and-streaming-potentially-large-csv-files-using-ruby-on-rails/">Generating and Streaming Potentially Large CSV Files Using Ruby on Rails</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-05-09T14:38:00-06:00" pubdate data-updated="true">May 9<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Most applications I&#8217;ve worked on at some point required that &#8216;Export&#8217; feature so people would be able to play with the data using the familiar Excel interface. I&#8217;m sharing some code here from a recent work that did the following:</p>

<p>Generate a CSV file for download with up to 100,000 rows in it. Since the contents of the file depends on some dynamic parameters, and the underlying data is changing all the time, the file must be generated live. Generating a large file takes time and the load balancer will drop the connection if it takes more than 1 minute. In fact, as a consumer I myself would be frustrated had it took even 1 minute to see something happening. This problem natually requires a streaming solution.</p>

<p>For a familiar example, let&#8217;s say we are downloading a CSV file containing transactions on an online store for the accounting folks. Lets say the URL is as follows:</p>

<p>http://transactions.com/transactions.csv?start=2013-01-01&amp;end=2013-04-30&amp;type=CreditCard&amp;min_amount=400</p>

<p>So, this would download a file containing the transactions from January to April of 2013, where a CreditCard was used for a purchase over $400. Here goes the code example with inline comments describing interesting parts.</p>

<figure class='code'><figcaption><span>app/models/transaction.rb</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Transaction</span>
</span><span class='line'>  <span class="n">belongs_to</span> <span class="ss">:store</span>
</span><span class='line'>  <span class="n">attr_accessible</span> <span class="ss">:time</span><span class="p">,</span> <span class="ss">:amount</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">csv_header</span>
</span><span class='line'>    <span class="c1">#Using ruby&#39;s built-in CSV::Row class</span>
</span><span class='line'>    <span class="c1">#true - means its a header</span>
</span><span class='line'>    <span class="no">CSV</span><span class="o">::</span><span class="no">Row</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="o">[</span><span class="ss">:time</span><span class="p">,</span> <span class="ss">:store</span><span class="p">,</span> <span class="ss">:amount</span><span class="o">]</span><span class="p">,</span> <span class="o">[</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="s1">&#39;Store&#39;</span><span class="p">,</span> <span class="s1">&#39;Amount&#39;</span><span class="o">]</span><span class="p">,</span> <span class="kp">true</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">to_csv_row</span>
</span><span class='line'>    <span class="no">CSV</span><span class="o">::</span><span class="no">Row</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">title</span><span class="p">:</span> <span class="n">title</span><span class="p">,</span> <span class="n">store</span><span class="p">:</span> <span class="n">store</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">amount</span><span class="p">:</span> <span class="n">amount</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">find_in_batches</span><span class="p">(</span><span class="n">filters</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">block</span><span class="p">)</span>
</span><span class='line'>    <span class="c1">#find_each will batch the results instead of getting all in one go</span>
</span><span class='line'>    <span class="n">where</span><span class="p">(</span><span class="n">filters</span><span class="p">)</span><span class="o">.</span><span class="n">find_each</span><span class="p">(</span><span class="n">batch_size</span><span class="p">:</span> <span class="n">batch_size</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">transaction</span><span class="o">|</span>
</span><span class='line'>      <span class="k">yield</span> <span class="n">transaction</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Given this Transaction model, the controller can call the methods and set appropriate http headers to stream the rows as they are generated instead of waiting for the whole file to be generated. Here&#8217;s the example controller code:</p>

<figure class='code'><figcaption><span>app/controllers/transactions_controller.rb</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">TransactionsController</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">index</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">respond_to</span> <span class="k">do</span> <span class="o">|</span><span class="nb">format</span><span class="o">|</span>
</span><span class='line'>
</span><span class='line'>      <span class="nb">format</span><span class="o">.</span><span class="n">csv</span> <span class="n">render_csv</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="kp">private</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">render_csv</span>
</span><span class='line'>    <span class="n">set_file_headers</span>
</span><span class='line'>    <span class="n">set_streaming_headers</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">response</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="mi">200</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">#setting the body to an enumerator, rails will iterate this enumerator</span>
</span><span class='line'>    <span class="nb">self</span><span class="o">.</span><span class="n">response_body</span> <span class="o">=</span> <span class="n">csv_lines</span><span class="p">(</span><span class="n">filters</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">set_file_headers</span>
</span><span class='line'>    <span class="n">file_name</span> <span class="o">=</span> <span class="s2">&quot;transactions.csv&quot;</span>
</span><span class='line'>    <span class="n">headers</span><span class="o">[</span><span class="s2">&quot;Content-Type&quot;</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;text/csv&quot;</span>
</span><span class='line'>    <span class="n">headers</span><span class="o">[</span><span class="s2">&quot;Content-disposition&quot;</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;attachment; filename=</span><span class="se">\&quot;</span><span class="si">#{</span><span class="n">file_name</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">&quot;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">set_streaming_headers</span>
</span><span class='line'>    <span class="c1">#nginx doc: Setting this to &quot;no&quot; will allow unbuffered responses suitable for Comet and HTTP streaming applications</span>
</span><span class='line'>    <span class="n">headers</span><span class="o">[</span><span class="s1">&#39;X-Accel-Buffering&#39;</span><span class="o">]</span> <span class="o">=</span> <span class="s1">&#39;no&#39;</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">headers</span><span class="o">[</span><span class="s2">&quot;Cache-Control&quot;</span><span class="o">]</span> <span class="o">||=</span> <span class="s2">&quot;no-cache&quot;</span>
</span><span class='line'>    <span class="n">headers</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="s2">&quot;Content-Length&quot;</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">csv_lines</span>
</span><span class='line'>
</span><span class='line'>    <span class="no">Enumerator</span><span class="o">.</span><span class="n">new</span> <span class="k">do</span> <span class="o">|</span><span class="n">y</span><span class="o">|</span>
</span><span class='line'>      <span class="n">y</span> <span class="o">&lt;&lt;</span> <span class="no">Transaction</span><span class="o">.</span><span class="n">csv_header</span><span class="o">.</span><span class="n">to_s</span>
</span><span class='line'>
</span><span class='line'>      <span class="c1">#ideally you&#39;d validate the params, skipping here for brevity</span>
</span><span class='line'>      <span class="no">Transaction</span><span class="o">.</span><span class="n">find_in_batches</span><span class="p">(</span><span class="n">params</span><span class="p">){</span> <span class="o">|</span><span class="n">transaction</span><span class="o">|</span> <span class="n">y</span> <span class="o">&lt;&lt;</span> <span class="n">transaction</span><span class="o">.</span><span class="n">to_csv_row</span><span class="o">.</span><span class="n">to_s</span> <span class="p">}</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>As you see in this example, it&#8217;s pretty straight forward once you put the pieces together. These streaming headers work under most servers including Passenger, Unicorn, etc. but webrick doesn&#8217;t support streaming responses. It took me some time to figure out the headers and the enumerator thing, but since then it&#8217;s working beautifully for us. Hope it will help someone with a similar need.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/05/07/simplicity-and-client-side-mvc/">Simplicity and Client-Side MVC</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-05-07T08:56:00-06:00" pubdate data-updated="true">May 7<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>After spending about 6 months on this new project using BackboneJS, and spending some hours learning AngularJS and EmberJS, my realization at this point is:</p>

<blockquote><p>Use Client-Side MVC very Selectively.</p></blockquote>

<p>Sometimes on a single page of your app, you need to offer a lot of interactions, each scoped to a small part of the page only. In such cases Client-Side MVC offers some neat features. I&#8217;ll try to share my perspective with some concrete examples where I&#8217;d say yes/no to Client-Side MVC.</p>

<ol>
<li>Build a Calendar page - Yes.</li>
<li>Build a Master/Detail view - No.</li>
<li>Build a Credit Card Payment Form - No.</li>
<li>Build a Story Wall like Trello - Yes.</li>
<li>Build an Airport Departures/Arrivals display - No.</li>
<li>Build a Search form - No.</li>
</ol>


<p>As you see here, I suggest using it only when a lot of Client-Side interactions can happen, with little server side data requests.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/7/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/5/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2020/12/30/software-architecture-part-2-people/">Software Architecture - Topic 2: People</a>
      </li>
    
      <li class="post">
        <a href="/blog/2020/12/26/software-artchitecture-part-1/">Software Architecture - Topic 1: Delightfulness</a>
      </li>
    
      <li class="post">
        <a href="/blog/2020/12/24/you-are-unfrogettable/">&#8220;you&#8217;re unfrogettable&#8221;</a>
      </li>
    
      <li class="post">
        <a href="/blog/2020/12/07/tribute-to-rails-date-time-great-invisible-design/">A Tribute to Time Travel APIs in Ruby on Rails</a>
      </li>
    
      <li class="post">
        <a href="/blog/2020/11/28/tips-for-developer-demos/">Tips for Great Developer Demos</a>
      </li>
    
  </ul>
</section>
<section>
  <h1>LinkedIn Profile</h1>
  <p>
    <a href="http://www.linkedin.com/in/sohan">SM Sohan</a>
  </p>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/smsohan">@smsohan</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'smsohan',
            count: ,
            skip_forks: ,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>






  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2021 - SM Sohan -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  











</body>
</html>
