
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Sohan's Blog</title>
  <meta name="author" content="SM Sohan">

  
  <meta name="description" content="In a previous post in this blog, I introduced the nice little acronym IMPACT for agile. To recap, here is what IMPACT stands for - &#8220;Iterative &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://smsohan.com/blog/page/19/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="" rel="alternate" title="Sohan's Blog" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-37549931-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body    class="collapse-sidebar sidebar-footer" >
  <header role="banner"><hgroup>
  <h1><a href="/">Sohan's Blog</a></h1>
  
    <h2>Things I'm Learning</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:smsohan.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/home">Home</a></li>
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/lifeline">Lifeline!</a></li>
  <li><a href="/blog/2013/04/05/call-me-sohan-and-ask-me-not-about-sm/">Call me Sohan!</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/11/26/part-1-how-am-i-impacting/">Part 1: How Am I IMPACTing Following Scrum?</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-11-26T00:00:00-07:00" pubdate data-updated="true">Nov 26<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
<p>In a previous post in this blog, I introduced the nice little acronym <a href="http://smsohan.blogspot.com/2008/11/impact-of-agile-software-development.html">IMPACT for agile</a>. To recap, here is what <strong>IMPACT</strong> stands f<em>or -</em></p>  <blockquote style="background-color: rgb(0, 128, 192);">   <p><span style="color: rgb(253, 253, 253);"><em><strong>&#8220;I</strong>terative and Incremental development of a software by means of <strong>M</strong>erciless refactoring, <strong>P</strong>eer reviews, <strong>A</strong>utomated acceptance testing, <strong>C</strong>ontinuous integration and of course, <strong>T</strong>est driven development&#8221;</em></span></p> </blockquote>  <p>To give you a little background around my story, let me tell you about a project that I am working since June 2006. The project is a micro-finance loan application automation server for the US financial industry. It acts as a mediator between a loan seeking customer and one of over 50 lenders in an attempt to get a loan for the customer. So, the server adds value by taking a single application to 50 odd lenders from a single submission unless no lender is left untried or some lender says &#8216;yes&#8217; to it. This is done in real time, the processing time in average is less than 3 minutes.</p>  <p>Now that you have the background, let me introduce the the challenges associated with this project. The bullet points are-</p>  <ul style="background-color: rgb(211, 249, 118);">   <li>Since this involves real dollars, there is nearly no margin for an error. </li>    <li>It processes more than a thousand loan applications per hour, so a high availability is a must. </li>    <li>This is done following agile Scrum and each two week one/two new lending partners need to be integrated. </li>    <li>The lending partners change their integration API from time to time and we need to accommodate the changes ASAP. </li> </ul>  <p>To address these challenges this is how we are responding-</p>  <p><strong>Iterative and Incremental development (IID)</strong></p>  <p>We are following Scrum and using <a href="http://www.scrumpad.com/">ScrumPad</a> to manage the IID. Basically, our clients/product owners put new requirements in terms of user stories in the product backlog at ScrumPad. So, with the prioritized product backlog we, the team, pick items to a sprint&#8217;s backlog. Then as usual, we break it down to tasks and do everything that it takes to meet the deadline of two weeks. Within a sprint the following are the milestones-</p>  <table style="color: rgb(255, 255, 255); background-color: rgb(0, 128, 192);" width="612" border="1" cellpadding="2" cellspacing="0"><tbody>     <tr>       <td valign="top" width="66">Day 1</td>        <td valign="top" width="57">Day 2</td>        <td valign="top" width="57">Day 3</td>        <td valign="top" width="57">Day 4</td>        <td valign="top" width="57">Day 5</td>        <td valign="top" width="57">Day 6</td>        <td valign="top" width="57">Day 7</td>        <td valign="top" width="57">Day 8</td>        <td valign="top" width="63">Day 9</td>        <td valign="top" width="82">Day 10</td>     </tr>      <tr>       <td style="font-weight: bold;" valign="top" width="68">Sprint Planning</td>        <td valign="top" width="56">Dev &amp; Test</td>        <td valign="top" width="56">Dev &amp; Test</td>        <td valign="top" width="56">Dev &amp; Test</td>        <td valign="top" width="57">Dev &amp; Test</td>        <td valign="top" width="57">Dev &amp; Test</td>        <td valign="top" width="57">Dev &amp; Test</td>        <td valign="top" width="57">Dev &amp; Test</td>        <td style="font-weight: bold;" valign="top" width="66">Test Release</td>        <td style="font-weight: bold;" valign="top" width="82">Production Release</td>     </tr>   </tbody></table>  <ul style="background-color: rgb(211, 249, 118);">   <li>8th day - Sprint works are completed. </li>    <li>9th day - Test delivery at a near production environment and feedback gathering from product owner. </li>    <li>10th day - Incorporate feedbacks and release in production. </li> </ul>  <p>Note that, we generally produce a number of test releases within the first 8 days. That gives us an earlier chance to gather client feedbacks.</p>  <p>The beauty if this approach is, with this model in place we can release as early as in 8 working days, if not earlier. So, this helps us meeting the last two challenges as mentioned above.</p>  <p><strong>Merciless refactoring</strong></p>  <p>Developing incrementally offers much challenge in attaining the longevity of the product. Because, naturally as new features come in, we need to make room for that in the existing implementation.To ensure the quality and life of the product, we do merciless refactoring as we go. We have over 90% unit test coverage, which helps us in doing this continuous refactoring. So, the idea is-</p>  <ul style="background-color: rgb(211, 249, 118);">   <li>Writing unit test and acceptance test. </li>    <li>Refactoring our code/design and validating against automated tests. </li> </ul>  <p><strong>Peer reviews</strong></p>  <p>This is probably the most important practice that I recommend. Because, as we had new members in the team, we found that the quality was somewhat degrading. Once, we started peer reviews, it was very helpful to the new comers as well as the veterans to keep the code quality up to the mark. We review the following things-</p>  <ul style="background-color: rgb(211, 249, 118);">   <li>Naming of variables, methods, classes, files, namespaces etc. </li>    <li>Use of private methods for increased readability. </li>    <li>Hard coded string literals or constants. </li>    <li>Long/nested loops and long running if-else blocks. </li>    <li>Code commenting. </li>    <li>Quality of coding. </li> </ul>  <p>I would suggest you to try Microsoft&#8217;s Stylecop, it will give you a great head start to ensure the first level code quality by enforcing the common rules. This practice is allowing us to continue the good quality over time.</p>  <p>I have always been shy of reading extra large text in the web. So, I thought I could better post this in two parts! I assure, next post will contain more images than texts, So, you better stay tuned for the next one&#8230;</p></div>
<h2>Comments</h2>
<div class='comments'>
<div class='comment'>
<div class='author'>Sohan</div>
<div class='content'>
@Hasan,<BR/>Thanks for the complement!<BR/>Yes, I am promoting the acronym. I believe this acronym somehow unites the best practices all in a single word. Just like how we need to unite these to make the most of our efforts!</div>
</div>
<div class='comment'>
<div class='author'>hasan</div>
<div class='content'>
nice acronym sohan bhai, lets spread the agile IMPACT!!</div>
</div>
</div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/11/18/impact-of-agile-software-development/">IMPACTing for Agile Software Development</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-11-18T00:00:00-07:00" pubdate data-updated="true">Nov 18<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
<p>Well, next time on a dev job interview when someone asks you the question, <em>&#8220;<span style="color:#5b2fdf;">Can you give us a brief idea on agile software development engineering practices?&#8221;</span>,</em> you are probably gonna laugh on your mind and just answer, <strong><span style="color:#355abd;">&#8220;IMPACT!&#8221;</span></strong>. Yes, this is it, compact and right on target!</p>  <p>Today, I came up with this acronym about agile engineering practices and I think its a nice one :-)</p>  <p><span style="font-size:130%;"><span style="color:#404040;"><strong>IMPACT</strong> can be elaborated as follows-</span></span></p>  <table width="659" border="0" cellpadding="2" cellspacing="0"><tbody>     <tr style="background-color: rgb(153, 62, 60);">       <td valign="top" width="49"><span style="font-size:130%;color:#ffffff;">I</span></td>        <td valign="top" width="58"><span style="font-size:130%;color:#ffffff;"><em>for</em></span></td>        <td valign="top" width="541"><span style="font-size:130%;color:#ffffff;">Iterative and Incremental Development</span></td>     </tr>      <tr style="background-color: rgb(192, 80, 77);">       <td valign="top" width="52"><span style="font-size:130%;color:#ffffff;">M</span></td>        <td valign="top" width="58"><span style="font-size:130%;color:#ffffff;"><em>for</em></span></td>        <td valign="top" width="541"><span style="font-size:130%;color:#ffffff;">Merciless Continuous Refactoring</span></td>     </tr>      <tr style="background-color: rgb(153, 62, 60);">       <td valign="top" width="54"><span style="font-size:130%;color:#ffffff;">P</span></td>        <td valign="top" width="58"><span style="font-size:130%;color:#ffffff;"><em>for</em></span></td>        <td valign="top" width="541"><span style="font-size:130%;color:#ffffff;">Peer Code Reviews</span></td>     </tr>      <tr style="background-color: rgb(192, 80, 77);">       <td valign="top" width="57"><span style="font-size:130%;color:#ffffff;">A</span></td>        <td valign="top" width="58"><span style="font-size:130%;color:#ffffff;"><em>for</em></span></td>        <td valign="top" width="541"><span style="font-size:130%;color:#ffffff;">Automated Acceptance Tests</span></td>     </tr>      <tr style="background-color: rgb(153, 62, 60);">       <td valign="top" width="59"><span style="font-size:130%;color:#ffffff;">C</span></td>        <td valign="top" width="58"><span style="font-size:130%;color:#ffffff;"><em>for</em></span></td>        <td valign="top" width="541"><span style="font-size:130%;color:#ffffff;">Continuous Integration</span></td>     </tr>      <tr style="background-color: rgb(192, 80, 77);">       <td valign="top" width="61"><span style="font-size:130%;color:#ffffff;">T</span></td>        <td valign="top" width="58"><span style="font-size:130%;color:#ffffff;"><em>for</em></span></td>        <td valign="top" width="541"><span style="font-size:130%;color:#ffffff;">Test Driven Development</span></td>     </tr>   </tbody></table>  <p>For all you agile folks out there, I hope this <strong>IMPACT</strong> makes sense to you! I have found many people to take agile as a panacea and start getting skeptical as soon as they feel the heat in real life. Well, we all know, there is no free lunch! So, lets get our feet on track and do the first things first. </p>  <p>What are the first things? The answer is, IMPACT, if you really want to create a positive impact out of agile methods.</p>  <p>Comments are welcome!</p></div>
<h2>Comments</h2>
<div class='comments'>
<div class='comment'>
<div class='author'>Sohan</div>
<div class='content'>
Thanks!</div>
</div>
<div class='comment'>
<div class='author'>Alexander Beletsky</div>
<div class='content'>
I really liked the idea of Impact :) nicely done!</div>
</div>
<div class='comment'>
<div class='author'>Sohan</div>
<div class='content'>
Syed,<BR/>Thanks for sharing your idea. I also think peer reviews are applicable to design and user stories.</div>
</div>
<div class='comment'>
<div class='author'>Syed</div>
<div class='content'>
Good one. I like it. Maybe &#8216;P&#8217; should stand for Peer review of stories/design/code, and not just code.</div>
</div>
</div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/11/18/delving-into-client-side-capabilities/">Delving Into Client Side Capabilities of ASP.Net Ajax</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-11-18T00:00:00-07:00" pubdate data-updated="true">Nov 18<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
<p>I believe the client side scripting capabilities of ASP.Net Ajax is not utilized by many ASP.Net developers. This is most probably due to the fact that, not many people are aware of it at the first place. Also, since most of the javascripts are rendered secretly (read, not blatantly, which is good), most developers don&#8217;t even feel the existence of the underlying javascript at all.</p>  <p>Two very simple examples of the client side library are given here as examples -</p>  <p>1. Did you know, if you have the following javascript method, it will be automatically called when your page&#8217;s DOM is finished loading?</p>  <pre>function pageLoad(sender, args) {<br />}</pre><br /><br /><p>2. Do you know the following javascript code will add an event handler to catch whenever an asynchronous post back is completed?</p><br /><br /><pre>Sys.WebForms.PageRequestManager.instance.add_endRequest(endRequestHandler)</pre><br /><br /><p>These are just very little glimpses of the big scenario. To uncover more, visit the official MSDN documentation at <a title="http://msdn.microsoft.com/en-au/library/bb398822.aspx" href="http://msdn.microsoft.com/en-au/library/bb398822.aspx">http://msdn.microsoft.com/en-au/library/bb398822.aspx</a> <br /><br />  <br />If you are new to this, I assure, you will have a much better knowledge about ASP.Net Ajax scripting than ever before and can produce better quality javascript for your ASP.Net websites. <br /><br />  <br />Happy digging!</p>  </div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/11/10/rowtest-extension-for-nunit/">RowTest Extension for NUnit</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-11-10T00:00:00-07:00" pubdate data-updated="true">Nov 10<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
<p>Well, I was just about to implement it myself! However, its good to see that the NUnit addin named RowTest actually allows us to do the data driven unit test through declarative programming and adding parameters to the dumb test methods!</p>  <p><a title="http://www.andreas-schlapsi.com/projects/rowtest-extension-for-nunit/" href="http://www.andreas-schlapsi.com/projects/rowtest-extension-for-nunit/">http://www.andreas-schlapsi.com/projects/rowtest-extension-for-nunit/</a></p>  <p>Check out this website for an example and get started with RowTest.</p></div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/11/03/iterative-and-incremental/">Iterative and Incremental Implementation of Code Reviews</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-11-03T00:00:00-07:00" pubdate data-updated="true">Nov 3<span>rd</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
<p>Extreme Programming (XP) advocates for a pair-programming, taking the code review to its extreme. I have also found that pair programming generates a lot of speed and also helps producing better quality product in the first time. But, at the same time it&#8217;s difficult to impress the management or prove return on investment  associated with pair programming to the business people. So, what is the best possible solution? I believe, we can implement frequent peer code reviews to mimic the pair programming to some extent and get the benefit out of it.</p>  <p>In our team, we started implementing code reviews as we now recognize that there is no way to live without it. As usual, our approach is an iterative and incremental approach. So, we are taking small steps and eventually embracing the best practices in the team. I would like to share our plan here in this blog. The review process goes on the following work flow-</p>  <p><em><span style="color:#8080ff;">&#8220;When I am done with my work on task, I commit the code with the reviewer&#8217;s name on the svn comment. CCNet automatically builds and sends a mail to the reviewer. The reviewer gets the review email through a filter and reviews the code and sends his feedback to me via IM/email.&#8221;</span></em></p>  <p><span style="color:#0000ff;"><strong>Sprint #1:</strong></span> Review all the names or classes, files, methods, variables and so on. So, the reviewer emphasizes on the names and provides feedback on the following things-</p>  <blockquote>   <p>1. Is the naming standard correctly followed?</p>    <p>2. Is this a meaningful identifier?</p>    <p>3. Does the name conform to the conventions used elsewhere in the code?</p> </blockquote>  <p><span style="color:#0000ff;"><strong>Sprint#2:</strong></span> Review the use of private methods and code structure. The to-do list is -</p>  <blockquote>   <p>1. Would it make more sense to put some code into the private method for readability and/or reusability?</p>    <p>2. Is there any hard-coded constant directly used without referring to a const/readonly data type?</p>    <p>3. For all the methods, is it possible to reduce the dependency by using a simple parameter instead of a whole object?</p>    <p>4. Learn from sprint#1 and use the common learning.</p> </blockquote>  <p><span style="color:#0000ff;"><strong>Sprint#3:</strong></span> Review the use of loops, if-else blocks. At this iteration, the to-do is-</p>  <blockquote>   <p>1. Is it possible to eliminate a loop?</p>    <p>2. Is it possible to avoid the nested loops?</p>    <p>3. Is there a large if-else-if-else block? Why is it required? Is this large conditional block a possible candidate for future change?</p>    <p>4. Learn from sprint#2 and use the common learning.</p> </blockquote>  <p>Well, this is pretty much it. The idea is, we feel its not practical to go with an overnight policy for implementing peer code reviews. But, its very much possible that we do it in small increments and at each sprint&#8217;s retrospective we bring this point. So, we are all informed that we need to do reviews, which, eventually should sustain as a best practice!</p>  <p>If you think you have some ideas regarding this, please share it with me/my readers.</p></div>
<h2>Comments</h2>
<div class='comments'>
<div class='comment'>
<div class='author'>Gregg Sporar</div>
<div class='content'>
Agreed, an incremental approach can work well.<br /><br />FYI, we&#39;re offering a special for one week only on our lightweight code review tool: Code Reviewer. $5 for 5 licenses - 5 days only (July 13-17).  Full details here: http://smartbear.com/code-review-5-for-5.php</div>
</div>
</div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/09/06/cruisecontrolnet-ccnet-configuration/">CruiseControl.Net (CCNet) Configuration Example for NCover</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-09-06T00:00:00-06:00" pubdate data-updated="true">Sep 6<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
<p><a href="http://ccnet.thoughtworks.com/">CruiseControl.Net</a> is a great continuous integration tool for .Net projects. It not only continuously builds your software but provides some really helpful reports to monitor your project&#8217;s progress.</p>  <p>In agile world, we all speak of self-testing code or test driven development (TDD). If we really want to ensure our code has enough test coverage, we need to use some tool to ease our lives and NCover is a good one for this purpose. To learn more about NCover, please visit <a href="http://www.ncover.com/">this</a>.</p>  <p>When integrating to CCNet, you can use a similar configuration in ccnet.config as shown below to show NCover reports for your project-</p> <!-- {\rtf1\ansi\ansicpg\lang1024\noproof65001\uc1 \deff0{\fonttbl{\f0\fnil\fcharset0\fprq1 Courier New;}}{\colortbl;??\red0\green0\blue255;\red255\green255\blue255;\red163\green21\blue21;\red0\green128\blue0;\red0\green0\blue0;}??\fs20 \cf1 <\cf3 tasks\cf1 >\par ??    <!--\cf4  Task for MSBuild \cf1 -->\par ??    <\cf3 msbuild\cf1 >\par ??      <\cf3 executable\cf1 >\cf0 C:&#92;WINDOWS&#92;Microsoft.NET&#92;Framework&#92;v3.5&#92;MSBuild.exe\cf1 \par ??      <\cf3 projectFile\cf1 >\cf0 CISample.sln\cf1 \par ??      <\cf3 buildArgs\cf1 >\cf0 /p:Configuration=Debug\cf1 \par ??      <\cf3 targets\cf1 >\cf0 Rebuild\cf1 \par ??      <\cf3 timeout\cf1 >\cf0 300\cf1 \par ??      <\cf3 logger\cf1 >\cf0 C:&#92;Program Files&#92;CruiseControl.NET&#92;server&#92;ThoughtWorks.CruiseControl.MsBuild.dll\cf1 \par ??    \par ??\par ??    <!--\cf4  Task for NUnit \cf1 -->\par ??    <\cf3 nunit\cf1 >\par ??      <\cf3 path\cf1 >\cf0 C:&#92;Program Files&#92;NUnit 2.4.1&#92;bin&#92;nunit-console.exe\cf1 \par ??      <\cf3 assemblies\cf1 >\par ??        <\cf3 assembly\cf1 >\cf0 CISample&#92;bin&#92;Debug&#92;CISample.dll\cf1 \par ??      \par ??    \par ??\par ??    <!--\cf4  Task for NCover \cf1 -->\par ??    <\cf3 exec\cf1 >\par ??      <\cf3 executable\cf1 >\cf0 ncover.console.exe\cf1 \par ??      <\cf3 baseDirectory\cf1 >\cf0 CISample&#92;bin&#92;Debug&#92;\cf1 \par ??      <\cf3 buildArgs\cf1 >\cf0 nunit-console CISample.dll //xml coverage.xml //ea NUnit.Framework.TestFixtureAttribute\cf1 \par ??    \par ??\par ??    <!--\cf4  Task for NCoverExplorer \cf1 -->\par ??    <\cf3 exec\cf1 >\par ??      <\cf3 executable\cf1 >\cf0 NCoverExplorer.Console.exe\cf1 \par ??      <\cf3 baseDirectory\cf1 >\cf0 CISample&#92;bin&#92;Debug&#92;\cf1 \par ??      <\cf3 buildArgs\cf1 >\cf0 coverage.xml /xml /r:ModuleMethodFunctionSummary\cf1 \par ??    \par ??\par ??  } &#8211;>  <div    style="background: white none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;font-family:courier new;font-size:10pt;color:black;">   <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   10</span> <span style="color:blue;">&lt;</span><span style="color: rgb(163, 21, 21);">tasks</span><span style="color:blue;">&gt;</span></p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   11</span> <span style="color:blue;">    &lt;!&#8211;</span><span style="color:green;"> Task for MSBuild </span><span style="color:blue;">&#8211;&gt;</span></p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   12</span> <span style="color:blue;">    &lt;</span><span style="color: rgb(163, 21, 21);">msbuild</span><span style="color:blue;">&gt;</span></p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   13</span> <span style="color:blue;">      &lt;</span><span style="color: rgb(163, 21, 21);">executable</span><span style="color:blue;">&gt;</span>C:\WINDOWS\Microsoft.NET\Framework\v3.5\MSBuild.exe<span style="color:blue;">&lt;/</span><span style="color: rgb(163, 21, 21);">executable</span><span style="color:blue;">&gt;</span></p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   14</span> <span style="color:blue;">      &lt;</span><span style="color: rgb(163, 21, 21);">projectFile</span><span style="color:blue;">&gt;</span>CISample.sln<span style="color:blue;">&lt;/</span><span style="color: rgb(163, 21, 21);">projectFile</span><span style="color:blue;">&gt;</span></p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   15</span> <span style="color:blue;">      &lt;</span><span style="color: rgb(163, 21, 21);">buildArgs</span><span style="color:blue;">&gt;</span>/p:Configuration=Debug<span style="color:blue;">&lt;/</span><span style="color: rgb(163, 21, 21);">buildArgs</span><span style="color:blue;">&gt;</span></p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   16</span> <span style="color:blue;">      &lt;</span><span style="color: rgb(163, 21, 21);">targets</span><span style="color:blue;">&gt;</span>Rebuild<span style="color:blue;">&lt;/</span><span style="color: rgb(163, 21, 21);">targets</span><span style="color:blue;">&gt;</span></p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   17</span> <span style="color:blue;">      &lt;</span><span style="color: rgb(163, 21, 21);">timeout</span><span style="color:blue;">&gt;</span>300<span style="color:blue;">&lt;/</span><span style="color: rgb(163, 21, 21);">timeout</span><span style="color:blue;">&gt;</span></p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   18</span> <span style="color:blue;">      &lt;</span><span style="color: rgb(163, 21, 21);">logger</span><span style="color:blue;">&gt;</span>C:\Program Files\CruiseControl.NET\server\ThoughtWorks.CruiseControl.MsBuild.dll<span style="color:blue;">&lt;/</span><span style="color: rgb(163, 21, 21);">logger</span><span style="color:blue;">&gt;</span></p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   19</span> <span style="color:blue;">    &lt;/</span><span style="color: rgb(163, 21, 21);">msbuild</span><span style="color:blue;">&gt;</span></p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   20</span> </p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   21</span> <span style="color:blue;">    &lt;!&#8211;</span><span style="color:green;"> Task for NUnit </span><span style="color:blue;">&#8211;&gt;</span></p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   22</span> <span style="color:blue;">    &lt;</span><span style="color: rgb(163, 21, 21);">nunit</span><span style="color:blue;">&gt;</span></p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   23</span> <span style="color:blue;">      &lt;</span><span style="color: rgb(163, 21, 21);">path</span><span style="color:blue;">&gt;</span>C:\Program Files\NUnit 2.4.1\bin\nunit-console.exe<span style="color:blue;">&lt;/</span><span style="color: rgb(163, 21, 21);">path</span><span style="color:blue;">&gt;</span></p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   24</span> <span style="color:blue;">      &lt;</span><span style="color: rgb(163, 21, 21);">assemblies</span><span style="color:blue;">&gt;</span></p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   25</span> <span style="color:blue;">        &lt;</span><span style="color: rgb(163, 21, 21);">assembly</span><span style="color:blue;">&gt;</span>CISample\bin\Debug\CISample.dll<span style="color:blue;">&lt;/</span><span style="color: rgb(163, 21, 21);">assembly</span><span style="color:blue;">&gt;</span></p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   26</span> <span style="color:blue;">      &lt;/</span><span style="color: rgb(163, 21, 21);">assemblies</span><span style="color:blue;">&gt;</span></p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   27</span> <span style="color:blue;">    &lt;/</span><span style="color: rgb(163, 21, 21);">nunit</span><span style="color:blue;">&gt;</span></p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   28</span> </p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   29</span> <span style="color:blue;">    &lt;!&#8211;</span><span style="color:green;"> Task for NCover </span><span style="color:blue;">&#8211;&gt;</span></p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   30</span> <span style="color:blue;">    &lt;</span><span style="color: rgb(163, 21, 21);">exec</span><span style="color:blue;">&gt;</span></p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   31</span> <span style="color:blue;">      &lt;</span><span style="color: rgb(163, 21, 21);">executable</span><span style="color:blue;">&gt;</span>ncover.console.exe<span style="color:blue;">&lt;/</span><span style="color: rgb(163, 21, 21);">executable</span><span style="color:blue;">&gt;</span></p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   32</span> <span style="color:blue;">      &lt;</span><span style="color: rgb(163, 21, 21);">baseDirectory</span><span style="color:blue;">&gt;</span>CISample\bin\Debug\<span style="color:blue;">&lt;/</span><span style="color: rgb(163, 21, 21);">baseDirectory</span><span style="color:blue;">&gt;</span></p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   33</span> <span style="color:blue;">      &lt;</span><span style="color: rgb(163, 21, 21);">buildArgs</span><span style="color:blue;">&gt;</span>nunit-console CISample.dll //xml coverage.xml //ea NUnit.Framework.TestFixtureAttribute<span style="color:blue;">&lt;/</span><span style="color: rgb(163, 21, 21);">buildArgs</span><span style="color:blue;">&gt;</span></p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   34</span> <span style="color:blue;">    &lt;/</span><span style="color: rgb(163, 21, 21);">exec</span><span style="color:blue;">&gt;</span></p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   35</span> </p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   36</span> <span style="color:blue;">    &lt;!&#8211;</span><span style="color:green;"> Task for NCoverExplorer </span><span style="color:blue;">&#8211;&gt;</span></p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   37</span> <span style="color:blue;">    &lt;</span><span style="color: rgb(163, 21, 21);">exec</span><span style="color:blue;">&gt;</span></p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   38</span> <span style="color:blue;">      &lt;</span><span style="color: rgb(163, 21, 21);">executable</span><span style="color:blue;">&gt;</span>NCoverExplorer.Console.exe<span style="color:blue;">&lt;/</span><span style="color: rgb(163, 21, 21);">executable</span><span style="color:blue;">&gt;</span></p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   39</span> <span style="color:blue;">      &lt;</span><span style="color: rgb(163, 21, 21);">baseDirectory</span><span style="color:blue;">&gt;</span>CISample\bin\Debug\<span style="color:blue;">&lt;/</span><span style="color: rgb(163, 21, 21);">baseDirectory</span><span style="color:blue;">&gt;</span></p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   40</span> <span style="color:blue;">      &lt;</span><span style="color: rgb(163, 21, 21);">buildArgs</span><span style="color:blue;">&gt;</span>coverage.xml /xml /r:ModuleMethodFunctionSummary<span style="color:blue;">&lt;/</span><span style="color: rgb(163, 21, 21);">buildArgs</span><span style="color:blue;">&gt;</span></p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   41</span> <span style="color:blue;">    &lt;/</span><span style="color: rgb(163, 21, 21);">exec</span><span style="color:blue;">&gt;</span></p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   42</span> </p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   43</span> <span style="color:blue;">  &lt;/</span><span style="color: rgb(163, 21, 21);">tasks</span><span style="color:blue;">&gt;</span></p> </div>  <p>You see that there are two NCover related &lt;exec&gt; nodes. The first one generates the coverage.xml. Then using this first one you can create actual report to present specifying the desired level of details of the report.</p></div>
<h2>Comments</h2>
<div class='comments'>
<div class='comment'>
<div class='author'>Abhishek Tyagi</div>
<div class='content'>
NUnit task in this example does not work.<br /><br />The warning : warning MSB6003: The specified task executable could not be run. The directory name is invalid<br /><br />the path is correct. can u help out in this issue thank you</div>
</div>
</div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/09/01/set-and-compile-using-c-language/">Set and Compile Using C# Language Version 2.0 in Visual Studio 2008</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-09-01T00:00:00-06:00" pubdate data-updated="true">Sep 1<span>st</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
<p>I know, while most of you are very happy with the new features in Visual Studio 2008, its sad that not all your deployment environments are upgraded to .Net framework 3.5. I had a similar situation as well on one of my projects.</p>  <p>Its great that you can just navigate to a VS 2008 project file properties and from the Application Tab select the Target .Net Framework version to use one of .Net 2.0, 3.0 and 3.5. But this doesn&#8217;t solve all the problems. You will soon discover that, your application doesn&#8217;t show an error when you write C# 3.0 code with the target framework set to 2.0. This is because, the IDE by default uses the latest language version by default.</p>  <p>To solve this problem, Navigate to <span style="color:#8080ff;"><strong>project properties &gt; Build &gt; Advanced &gt; Language Version and choose ISO-2 (or ISO-1).</strong></span> Now with this information, the VS 2008 will start showing compiler errors for features that don&#8217;t comply to the version specification!</p></div>
<h2>Comments</h2>
<div class='comments'>
<div class='comment'>
<div class='author'>Jeff Sinclair</div>
<div class='content'>
The important thing to remember is that if you compile using c# 3.0 features, this does not mean that the compiled output won&#8217;t run on 2.0 Most of the c# 3 features are compile time only. <BR/>Be clear on if you want to be restricted at compile time, or if your goal is to have the output work on 2.0 at runtime.</div>
</div>
</div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/09/01/bdd-my-first-bdd-code-using-rspec-in/">BDD - My First BDD Code Using RSpec in Ruby</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-09-01T00:00:00-06:00" pubdate data-updated="true">Sep 1<span>st</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
<p>I am really really happy to see people putting so much efforts for building high quality, nearly all avoidable error free software. I am a big believer of Test Driven Development and doing TDD for about two years now. I have always had the feeling that TDD is a kind of a misnomer because to some people the term &#8216;Test&#8217; refers to finding bugs. For this very reason, when people gets started with TDD, they consider it as a waste of time to write so much extra code that doesn&#8217;t necessarily find bugs!</p>  <p>Well, a good vocabulary always makes it more attractive and useful. Now with BDD, Behavior Driven Development, I think the vocabulary that people actually codes the behaviors and implements the behaviors, not the tests, makes it more like it.</p>  <p>So, lets see my first ever written RSpec ruby code and the sexy html output!</p>  <p>#This is a poor Stack implementation</p>  <p><span style="color:#404040;">class</span> Stack   <br />   <span style="color:#404040;">def</span> initialize   <br />       @items = []   <br />   end   <br />   def push(item)   <br />       @items &lt;&lt; item   <br />   end   <br />   def pop   <br />       return nil unless @items &amp;&amp; @items.length &gt; 0   <br />       item = @items.last   <br />       @items.delete item   <br />       return item   <br />   end   <br />   def peek   <br />       return nil unless @items &amp;&amp; @items.length &gt; 0   <br />       @items.last   <br />   end   <br />   def empty?   <br />       @items.empty?   <br />   end   <br />end</p>  <p>#This is the RSpec ruby code. Isn&#8217;t is Simple?</p>  <p>describe Stack do  <br />   before(:each) do   <br />       @stack = Stack.new   <br />   end   <br />   describe &#8220;Empty&#8221; do   <br />       it &#8220;Should be empty when created&#8221; do   <br />           @stack.empty?.should == true   <br />       end   <br />   end   <br />   describe &#8220;With One Item (value = 3)&#8221; do   <br />       before(:each) do   <br />           @stack.push(3)   <br />       end   <br />       it &#8220;should not be empty&#8221; do   <br />           @stack.empty?.should be_false   <br />       end   <br />       it &#8220;should return the item (=3) when #peek&#8221; do   <br />           @stack.peek.should == 3   <br />       end   <br />       it &#8220;should return the item (=3) when #pop&#8221; do   <br />           @stack.pop.should == 3   <br />       end   <br />   end   <br />end</p>  <p>Well, we all write codes and are doing this day and night for years. What I like to see is as sexy an output as the following from my source code :-)</p>  <p><a href="http://lh5.ggpht.com/sohan39/SLu558pW0rI/AAAAAAAAAD8/1nk1GLN_mBM/s1600-h/RSpec%5B12%5D.jpg"><img style="border: 0px none ;" alt="RSpec" src="http://lh3.ggpht.com/sohan39/SLu57kNJhoI/AAAAAAAAAEA/ZIjSLFPkOOk/RSpec_thumb%5B8%5D.jpg?imgmax=800" width="812" border="0" height="244" /></a> </p>  <p>I know, you liked the output. For more you may check at <a title="http://rspec.info/" href="http://rspec.info/">http://rspec.info/</a></p>  <p>Need a similar solution on .Net? Keep Googling and come back to me if you see a good BDD tool. I would really like to use BDD in my .Net projects and see how better it performs over TDD. </p></div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/08/20/my-target-items-still-in-2008-learning/">My Target Items Still in the 2008 Learning Queue</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-08-20T00:00:00-06:00" pubdate data-updated="true">Aug 20<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
<p>1. Windows Workflow foundation.</p>  <p>2. Study about ERP and take a good look into a popular open-source ERP application.</p>  <p>3. Study on SOA.</p>  <p>4. Study on Smart Client applications.</p>  </div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/08/13/unit-testing-using-mocks-fillwithmocks/">Unit Testing Using Mocks - FillWithMocks, Fill All or Only Selected Properties With Mocks Using Only a Single Method Call</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-08-13T00:00:00-06:00" pubdate data-updated="true">Aug 13<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
<p>I have been doing TDD for about two years now and using mock testing for interaction based unit testing in my projects. What I have learned over this time is, a unit testable design leads to introduction of interfaces and dependency injection for testing a code in isolation. And when I want to perform tests on my interactions, I need to create mock objects and inject these mock instances to my object under test. Sometimes, a unit test class needs to create quite a few of such mock objects and I feel this can be done using a simple wrapper around the usual mocking frameworks.</p>  <p>I suggest a similar and even more powerful wrapper so that you don&#8217;t need to create instances for each of the mock objects, rather do it in a single call for all your desired mocks. I have shown this method for NMock2, however, its evident that you can write your own method for your favorite mocking framework just using this code as a reference.</p>  <p>This code is written in C# 3.0 and should compile in .Net 3.5. You will need to add a reference to NMock2 to compile this. Also, you need to know a bit about Reflection to understand the following code fragment.</p>  <p><strong>Disclaimer:</strong> This code is just a simple example and it may not suit all your needs.</p> <!-- {\rtf1\ansi\ansicpg\lang1024\noproof65001\uc1 \deff0{\fonttbl{\f0\fnil\fcharset0\fprq1 Courier New;}}{\colortbl;??\red0\green0\blue255;\red255\green255\blue255;\red0\green0\blue0;\red43\green145\blue175;\red128\green128\blue128;\red0\green128\blue0;\red163\green21\blue21;}??\fs20 \cf1 using\cf0  System;\par ??\cf1 using\cf0  System.Collections.Generic;\par ??\cf1 using\cf0  System.Linq;\par ??\cf1 using\cf0  System.Text;\par ??\cf1 using\cf0  System.Reflection;\par ??\par ??\par ??\cf1 namespace\cf0  NMock2.Extensions\par ??\{\par ??    \cf1 public\cf0  \cf1 static\cf0  \cf1 class\cf0  \cf4 MockeryExtensions\par ??\cf0     \{\par ??        \cf5 ///\cf6  \cf5 <summary>\par ??\cf0         \cf5 ///\cf6  This method will fill all properties of the &#8216;target&#8217; of interface type having a setter\par ??\cf0         \cf5 ///\cf6  \cf5 </summary>\par ??\cf0         \cf5 ///\cf6  \cf5 <param name="mocks"></param>\par ??\cf0         \cf5 ///\cf6  \cf5 <param name="target"></param>\par ??\cf0         \cf1 public\cf0  \cf1 static\cf0  \cf1 void\cf0  FillWithMocks(\cf1 this\cf0  \cf4 Mockery\cf0  mocks, \cf1 object\cf0  target)\par ??        \{\par ??            \cf4 Type\cf0  targetType = target.GetType();\par ??            \cf4 PropertyInfo\cf0  []properties = target.GetType().GetProperties();\par ??            \par ??            \cf1 foreach\cf0  (\cf4 PropertyInfo\cf0  property \cf1 in\cf0  properties)\par ??            \{\par ??                \cf4 Type\cf0  ptype = property.PropertyType;\par ??                \cf1 if\cf0  (ptype.IsInterface)\par ??                \{\par ??                    \cf1 if\cf0 (targetType.GetMethod(\cf1 string\cf0 .Format(\cf7 &#8220;set_\{0\}&#8221;\cf0 , property.Name)) != \cf1 null\cf0 )\par ??                    \{\par ??                        targetType.GetProperty(property.Name).SetValue(target, mocks.NewMock(ptype), \cf1 new\cf0  \cf1 object\cf0 [] \{ \});\par ??                    \}\par ??                \}\par ??            \}\par ??        \}\par ??\par ??        \cf5 ///\cf6  \cf5 <summary>\par ??\cf0         \cf5 ///\cf6  This method will fill the properties with names specified in the propertyNames array having a setter\par ??\cf0         \cf5 ///\cf6  \cf5 </summary>\par ??\cf0         \cf5 ///\cf6  \cf5 <param name="mocks"></param>\par ??\cf0         \cf5 ///\cf6  \cf5 <param name="target"></param>\par ??\cf0         \cf5 ///\cf6  \cf5 <param name="propertyNames"></param>\par ??\cf0         \cf1 public\cf0  \cf1 static\cf0  \cf1 void\cf0  FillWithMocks(\cf1 this\cf0  \cf4 Mockery\cf0  mocks, \cf1 object\cf0  target, \cf1 params\cf0  \cf1 string\cf0 [] propertyNames)\par ??        \{\par ??            \cf4 Type\cf0  targetType = target.GetType();\par ??            \cf1 foreach\cf0  (\cf1 string\cf0  propertyName \cf1 in\cf0  propertyNames)\par ??            \{\par ??                \cf4 PropertyInfo\cf0  pInfo = targetType.GetProperty(propertyName);\par ??                \cf1 if\cf0  (pInfo != \cf1 null\cf0  &amp;&amp; targetType.GetMethod(\cf1 string\cf0 .Format(\cf7 &#8220;set_\{0\}&#8221;\cf0 , propertyName)) != \cf1 null\cf0 )\par ??                \{\par ??                    pInfo.SetValue(target, mocks.NewMock(pInfo.PropertyType), \cf1 null\cf0 );\par ??                \}\par ??                \cf1 else\par ??\cf0                 \{\par ??                    \cf1 throw\cf0  \cf1 new\cf0  \cf4 ArgumentException\cf0 (\cf1 string\cf0 .Format(\cf7 &#8220;the property \{0\} is not found or does not have a setter&#8221;\cf0 , pInfo.Name));\par ??                \}\par ??            \}\par ??        \}\par ??    \}\par ??\}\par ??} &#8211;>  <div    style="background: white none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;font-family:courier new;font-size:10pt;color:black;">   <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">    1</span> <span style="color:blue;">using</span> System;</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">    2</span> <span style="color:blue;">using</span> System.Collections.Generic;</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">    3</span> <span style="color:blue;">using</span> System.Linq;</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">    4</span> <span style="color:blue;">using</span> System.Text;</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">    5</span> <span style="color:blue;">using</span> System.Reflection;</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">    6</span> </p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">    7</span> </p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">    8</span> <span style="color:blue;">namespace</span> NMock2.Extensions</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">    9</span> {</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   10</span>     <span style="color:blue;">public</span> <span style="color:blue;">static</span> <span style="color:blue;">class</span> <span style="color: rgb(43, 145, 175);">MockeryExtensions</span></p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   11</span>     {</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   12</span>         <span style="color:gray;">///</span><span style="color:green;"> </span><span style="color:gray;">&lt;summary&gt;</span></p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   13</span>         <span style="color:gray;">///</span><span style="color:green;"> This method will fill all properties of the &#8216;target&#8217; of interface type having a setter</span></p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   14</span>         <span style="color:gray;">///</span><span style="color:green;"> </span><span style="color:gray;">&lt;/summary&gt;</span></p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   15</span>         <span style="color:gray;">///</span><span style="color:green;"> </span><span style="color:gray;">&lt;param name=&#8221;mocks&#8221;&gt;&lt;/param&gt;</span></p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   16</span>         <span style="color:gray;">///</span><span style="color:green;"> </span><span style="color:gray;">&lt;param name=&#8221;target&#8221;&gt;&lt;/param&gt;</span></p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   17</span>         <span style="color:blue;">public</span> <span style="color:blue;">static</span> <span style="color:blue;">void</span> FillWithMocks(<span style="color:blue;">this</span> <span style="color: rgb(43, 145, 175);">Mockery</span> mocks, <span style="color:blue;">object</span> target)</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   18</span>         {</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   19</span>             <span style="color: rgb(43, 145, 175);">Type</span> targetType = target.GetType();</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   20</span>             <span style="color: rgb(43, 145, 175);">PropertyInfo</span> []properties = target.GetType().GetProperties();</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   21</span> </p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   22</span>             <span style="color:blue;">foreach</span> (<span style="color: rgb(43, 145, 175);">PropertyInfo</span> property <span style="color:blue;">in</span> properties)</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   23</span>             {</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   24</span>                 <span style="color: rgb(43, 145, 175);">Type</span> ptype = property.PropertyType;</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   25</span>                 <span style="color:blue;">if</span> (ptype.IsInterface)</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   26</span>                 {</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   27</span>                     <span style="color:blue;">if</span>(targetType.GetMethod(<span style="color:blue;">string</span>.Format(<span style="color: rgb(163, 21, 21);">&#8220;set_{0}&#8221;</span>, property.Name)) != <span style="color:blue;">null</span>)</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   28</span>                     {</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   29</span>                         targetType.GetProperty(property.Name).SetValue(target, mocks.NewMock(ptype), <span style="color:blue;">new</span> <span style="color:blue;">object</span>[] { });</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   30</span>                     }</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   31</span>                 }</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   32</span>             }</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   33</span>         }</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   34</span> </p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   35</span>         <span style="color:gray;">///</span><span style="color:green;"> </span><span style="color:gray;">&lt;summary&gt;</span></p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   36</span>         <span style="color:gray;">///</span><span style="color:green;"> This method will fill the properties with names specified in the propertyNames array having a setter</span></p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   37</span>         <span style="color:gray;">///</span><span style="color:green;"> </span><span style="color:gray;">&lt;/summary&gt;</span></p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   38</span>         <span style="color:gray;">///</span><span style="color:green;"> </span><span style="color:gray;">&lt;param name=&#8221;mocks&#8221;&gt;&lt;/param&gt;</span></p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   39</span>         <span style="color:gray;">///</span><span style="color:green;"> </span><span style="color:gray;">&lt;param name=&#8221;target&#8221;&gt;&lt;/param&gt;</span></p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   40</span>         <span style="color:gray;">///</span><span style="color:green;"> </span><span style="color:gray;">&lt;param name=&#8221;propertyNames&#8221;&gt;&lt;/param&gt;</span></p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   41</span>         <span style="color:blue;">public</span> <span style="color:blue;">static</span> <span style="color:blue;">void</span> FillWithMocks(<span style="color:blue;">this</span> <span style="color: rgb(43, 145, 175);">Mockery</span> mocks, <span style="color:blue;">object</span> target, <span style="color:blue;">params</span> <span style="color:blue;">string</span>[] propertyNames)</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   42</span>         {</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   43</span>             <span style="color: rgb(43, 145, 175);">Type</span> targetType = target.GetType();</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   44</span>             <span style="color:blue;">foreach</span> (<span style="color:blue;">string</span> propertyName <span style="color:blue;">in</span> propertyNames)</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   45</span>             {</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   46</span>                 <span style="color: rgb(43, 145, 175);">PropertyInfo</span> pInfo = targetType.GetProperty(propertyName);</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   47</span>                 <span style="color:blue;">if</span> (pInfo != <span style="color:blue;">null</span> &amp;&amp; targetType.GetMethod(<span style="color:blue;">string</span>.Format(<span style="color: rgb(163, 21, 21);">&#8220;set_{0}&#8221;</span>, propertyName)) != <span style="color:blue;">null</span>)</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   48</span>                 {</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   49</span>                     pInfo.SetValue(target, mocks.NewMock(pInfo.PropertyType), <span style="color:blue;">null</span>);</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   50</span>                 }</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   51</span>                 <span style="color:blue;">else</span></p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   52</span>                 {</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   53</span>                     <span style="color:blue;">throw</span> <span style="color:blue;">new</span> <span style="color: rgb(43, 145, 175);">ArgumentException</span>(<span style="color:blue;">string</span>.Format(<span style="color: rgb(163, 21, 21);">&#8220;the property {0} is not found or does not have a setter&#8221;</span>, pInfo.Name));</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   54</span>                 }</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   55</span>             }</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   56</span>         }</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   57</span>     }</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   58</span> }</p> </div>  <p>So, with this extension method in place, you can go and write your test code in a much compact manner. The following is an example showing one possible use of this method in your NUnit test code.</p> <!-- {\rtf1\ansi\ansicpg\lang1024\noproof65001\uc1 \deff0{\fonttbl{\f0\fnil\fcharset0\fprq1 Courier New;}}{\colortbl;??\red0\green0\blue255;\red255\green255\blue255;\red0\green0\blue0;\red43\green145\blue175;\red0\green128\blue0;\red163\green21\blue21;}??\fs20 \cf1 public\cf0  \cf1 interface\cf0  \cf4 IMyInterface\par ??\cf0     \{\par ??        \cf1 void\cf0  MyMethod(\cf1 string\cf0  name);\par ??    \}\par ??\par ??    \cf1 public\cf0  \cf1 class\cf0  \cf4 MyExampleClass\par ??\cf0     \{\par ??        \cf1 public\cf0  \cf4 IMyInterface\cf0  MyPropertyOne\par ??        \{\par ??            \cf1 get\cf0 ;\par ??            \cf1 set\cf0 ;\par ??        \}\par ??\par ??        \cf1 public\cf0  \cf4 IMyInterface\cf0  MyPropertyTwo\par ??        \{\par ??            \cf1 get\cf0 ;\par ??            \cf1 set\cf0 ;\par ??        \}\par ??\par ??        \cf1 public\cf0  \cf4 IMyInterface\cf0  MyPropertyThree\par ??        \{\par ??            \cf1 get\cf0 ;\par ??            \cf1 set\cf0 ;\par ??        \}\par ??\par ??        \cf1 public\cf0  MyExampleClass()\par ??        \{\par ??\par ??        \}\par ??    \}\par ??\par ??    [\cf4 TestFixture\cf0 ]\par ??    \cf1 public\cf0  \cf1 class\cf0  \cf4 MyExampleClassTest\par ??\cf0     \{\par ??        \cf1 private\cf0  \cf4 MyExampleClass\cf0  _myExampleClass;\par ??        \cf1 private\cf0  \cf4 Mockery\cf0  _mocks;\par ??\par ??        [\cf4 SetUp\cf0 ]\par ??        \cf1 public\cf0  \cf1 void\cf0  Init()\par ??        \{\par ??            _myExampleClass = \cf1 new\cf0  \cf4 MyExampleClass\cf0 ();\par ??            _mocks = \cf1 new\cf0  \cf4 Mockery\cf0 ();\par ??\par ??            \cf5 //This class fills both the properties with mocks\par ??\cf0             _mocks.FillWithMocks(_myExampleClass);\par ??\par ??            \cf5 //This class fills only MyPropertyOne and MyPropertyTwo with mocks\par ??\cf0             _mocks.FillWithMocks(_myExampleClass, \cf6 "MyPropertyOne"\cf0 , \cf6 "MyPropertyTwo"\cf0 );\par ??        \}\par ??    \}} -->  <div    style="background: white none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;font-family:courier new;font-size:10pt;color:black;">   <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   83</span>     <span style="color:blue;">public</span> <span style="color:blue;">interface</span> <span style="color: rgb(43, 145, 175);">IMyInterface</span></p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   84</span>     {</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   85</span>         <span style="color:blue;">void</span> MyMethod(<span style="color:blue;">string</span> name);</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   86</span>     }</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   87</span> </p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   88</span>     <span style="color:blue;">public</span> <span style="color:blue;">class</span> <span style="color: rgb(43, 145, 175);">MyExampleClass</span></p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   89</span>     {</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   90</span>         <span style="color:blue;">public</span> <span style="color: rgb(43, 145, 175);">IMyInterface</span> MyPropertyOne</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   91</span>         {</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   92</span>             <span style="color:blue;">get</span>;</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   93</span>             <span style="color:blue;">set</span>;</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   94</span>         }</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   95</span> </p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   96</span>         <span style="color:blue;">public</span> <span style="color: rgb(43, 145, 175);">IMyInterface</span> MyPropertyTwo</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   97</span>         {</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   98</span>             <span style="color:blue;">get</span>;</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">   99</span>             <span style="color:blue;">set</span>;</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">  100</span>         }</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">  101</span> </p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">  102</span>         <span style="color:blue;">public</span> <span style="color: rgb(43, 145, 175);">IMyInterface</span> MyPropertyThree</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">  103</span>         {</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">  104</span>             <span style="color:blue;">get</span>;</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">  105</span>             <span style="color:blue;">set</span>;</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">  106</span>         }</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">  107</span> </p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">  108</span>         <span style="color:blue;">public</span> MyExampleClass()</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">  109</span>         {</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">  110</span> </p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">  111</span>         }</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">  112</span>     }</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">  113</span> </p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">  114</span>     [<span style="color: rgb(43, 145, 175);">TestFixture</span>]</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">  115</span>     <span style="color:blue;">public</span> <span style="color:blue;">class</span> <span style="color: rgb(43, 145, 175);">MyExampleClassTest</span></p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">  116</span>     {</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">  117</span>         <span style="color:blue;">private</span> <span style="color: rgb(43, 145, 175);">MyExampleClass</span> _myExampleClass;</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">  118</span>         <span style="color:blue;">private</span> <span style="color: rgb(43, 145, 175);">Mockery</span> _mocks;</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">  119</span> </p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">  120</span>         [<span style="color: rgb(43, 145, 175);">SetUp</span>]</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">  121</span>         <span style="color:blue;">public</span> <span style="color:blue;">void</span> Init()</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">  122</span>         {</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">  123</span>             _myExampleClass = <span style="color:blue;">new</span> <span style="color: rgb(43, 145, 175);">MyExampleClass</span>();</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">  124</span>             _mocks = <span style="color:blue;">new</span> <span style="color: rgb(43, 145, 175);">Mockery</span>();</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">  125</span> </p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">  126</span>             <span style="color:green;">//This call fills all the three properties with mocks</span></p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">  127</span>             _mocks.FillWithMocks(_myExampleClass);</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">  128</span> </p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">  129</span>             <span style="color:green;">//This call fills only MyPropertyOne and MyPropertyTwo with mocks</span></p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">  130</span>             _mocks.FillWithMocks(_myExampleClass, <span style="color: rgb(163, 21, 21);">&#8220;MyPropertyOne&#8221;</span>, <span style="color: rgb(163, 21, 21);">&#8220;MyPropertyTwo&#8221;</span>);</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">  131</span>         }</p>    <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">  132</span>     }</p> </div>  <p>Comments are welcome!</p></div>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/20/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/18/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2020/12/07/tribute-to-rails-date-time-great-invisible-design/">A Tribute to Time Travel APIs in Ruby on Rails</a>
      </li>
    
      <li class="post">
        <a href="/blog/2020/11/28/tips-for-developer-demos/">Tips for Great Developer Demos</a>
      </li>
    
      <li class="post">
        <a href="/blog/2020/11/18/where-to-learn/">Where to Learn: 10 Ways I Do</a>
      </li>
    
      <li class="post">
        <a href="/blog/2020/11/12/learn-to-get-and-give-feedback/">Learn to Get and Give Feedback</a>
      </li>
    
      <li class="post">
        <a href="/blog/2020/11/04/youtube/">My YouTube Playlist for Leadership</a>
      </li>
    
  </ul>
</section>
<section>
  <h1>LinkedIn Profile</h1>
  <p>
    <a href="http://www.linkedin.com/in/sohan">SM Sohan</a>
  </p>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/smsohan">@smsohan</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'smsohan',
            count: ,
            skip_forks: ,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>






  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2020 - SM Sohan -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  











</body>
</html>
